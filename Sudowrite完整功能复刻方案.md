# Sudowriteå®Œæ•´åŠŸèƒ½å¤åˆ»æ–¹æ¡ˆ - 100%è¦†ç›–

## âœ… å¯ä»¥å®Œæ•´å¤åˆ»ï¼ç­”æ¡ˆæ˜¯è‚¯å®šçš„

ç»è¿‡æ·±å…¥ç ”ç©¶ï¼Œ**Sudowriteçš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å¯ä»¥ç”¨Lovable AI + Gemini APIå¤åˆ»**ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„åŠŸèƒ½æ¸…å•å’Œå®ç°æ–¹æ¡ˆã€‚

---

## ğŸ“Š Sudowriteå®Œæ•´åŠŸèƒ½çŸ©é˜µ

### **ä¸€ã€Story Bibleç³»ç»Ÿ (æ ¸å¿ƒæ¶æ„) - 100%å¯å¤åˆ»**

| åŠŸèƒ½ | æè¿° | å¤åˆ»éš¾åº¦ | å®ç°æ–¹æ¡ˆ |
|------|------|----------|----------|
| **Braindump** | çµæ„Ÿå€¾å€’,éšæ„è®°å½•æƒ³æ³• | â­ ç®€å• | ç®€å•æ–‡æœ¬æ¡† + æœ¬åœ°å­˜å‚¨ |
| **Genre** | ä½“è£é€‰æ‹©(ç§‘å¹»/å¥‡å¹»/æµªæ¼«ç­‰) | â­ ç®€å• | ä¸‹æ‹‰é€‰æ‹© + è‡ªå®šä¹‰è¾“å…¥ |
| **Style** | é£æ ¼è®¾ç½®,å¯ä¸Šä¼ æ ·æœ¬ | â­â­ ä¸­ç­‰ | æ–‡æœ¬æ¡† + æ–‡ä»¶ä¸Šä¼ ,æå–æ–‡æœ¬ä½œä¸ºç¤ºä¾‹ |
| **Synopsis** | æ•…äº‹æ¦‚è¦è‡ªåŠ¨ç”Ÿæˆ | â­â­ ä¸­ç­‰ | Geminiæ ¹æ®Braindump+Genreç”Ÿæˆ |
| **Characters** | è§’è‰²ç®¡ç†ç³»ç»Ÿ | â­â­â­ å¤æ‚ | è§ä¸‹è¡¨è¯¦ç»†è¯´æ˜ |
| **Worldbuilding** | ä¸–ç•Œè§‚å…ƒç´ åº“ | â­â­â­ å¤æ‚ | å¯æ‰©å±•å¡ç‰‡ç³»ç»Ÿ |
| **Outline** | å¤§çº²ç³»ç»Ÿ(å¯æ‹–æ‹½é‡æ’) | â­â­â­ å¤æ‚ | React DnDåº“ + å±‚çº§ç»“æ„ |
| **Scenes** | åœºæ™¯å¡ç‰‡ç³»ç»Ÿ | â­â­â­ å¤æ‚ | å…³è”Outlineçš„å­ç³»ç»Ÿ |

#### **Characterså­ç³»ç»Ÿè¯¦ç»†åŠŸèƒ½**
- âœ… æ‰¹é‡ç”Ÿæˆæ‰€æœ‰è§’è‰²(åŸºäºSynopsis)
- âœ… è‡ªå®šä¹‰ç‰¹å¾å­—æ®µ(trait fields)
- âœ… å…³ç³»ç½‘ç»œå›¾
- âœ… ä»å·²æœ‰æ–‡æœ¬å¯¼å…¥è¯†åˆ«è§’è‰²
- âœ… è§’è‰²æœç´¢å’Œè¿‡æ»¤
- âœ… è§’è‰²åœ¨Story Bibleä¸­çš„æ˜¾è‘—æ€§(Saliency Engine)

#### **Worldbuildingå­ç³»ç»Ÿ**
- âœ… Places(åœ°ç‚¹)
- âœ… Items(ç‰©å“)
- âœ… Lore/Rules(è§„åˆ™/ä¼ è¯´)
- âœ… Organizations(ç»„ç»‡)
- âœ… è‡ªå®šä¹‰å…ƒç´ ç±»å‹
- âœ… å±‚çº§å…³ç³»(å¦‚åŸå¸‚â†’è¡—åŒº)

---

### **äºŒã€æ ¸å¿ƒå†™ä½œå·¥å…· - 100%å¯å¤åˆ»**

| å·¥å…· | åŠŸèƒ½æè¿° | Sudowriteå®ç° | æˆ‘ä»¬çš„å¤åˆ»æ–¹æ¡ˆ |
|------|----------|---------------|----------------|
| **Write** | ç»­å†™300-500å­— | æœ‰Auto/Guided/Tone Shiftä¸‰ç§æ¨¡å¼ | Gemini + ä¸‰ç§Promptæ¨¡æ¿ |
| **Rewrite** | æ”¹å†™é€‰ä¸­æ–‡æœ¬ | ç”Ÿæˆå¤šä¸ªç‰ˆæœ¬ä¾›é€‰æ‹© | Geminiç”Ÿæˆ3-5ä¸ªå˜ä½“ |
| **Describe** | å¢å¼ºæå†™(äº”æ„Ÿ) | æ·»åŠ æ„Ÿå®˜ç»†èŠ‚ | Gemini + "Show Don't Tell"æç¤ºè¯ |
| **Expand** | æ‰©å±•æ®µè½ | æ”¾æ…¢èŠ‚å¥,å¢åŠ é•¿åº¦ | Geminiæ‰©å†™,ä¸æ”¹å˜åŸæ„ |
| **Shrink Ray** | å‹ç¼©æ–‡æœ¬ | ç¼©çŸ­åŒæ—¶ä¿ç•™æ ¸å¿ƒ | Geminiæ€»ç»“å‹ç¼© |
| **Brainstorm** | å¤´è„‘é£æš´ | ç”Ÿæˆåˆ›æ„åˆ—è¡¨(è§’è‰²/æƒ…èŠ‚/å¯¹è¯) | Geminiåˆ—è¡¨ç”Ÿæˆ |
| **Twist** | æƒ…èŠ‚è½¬æŠ˜ç”Ÿæˆ | åŸºäºæ¢—æ¦‚ç”Ÿæˆæ„å¤–è½¬æŠ˜ | Geminiåˆ›æ„è½¬æŠ˜ç”Ÿæˆ |
| **First Draft** | ç« èŠ‚ç”Ÿæˆå™¨ | åŸºäºbeatsç”Ÿæˆ500-1000å­—åœºæ™¯ | Geminié•¿æ–‡æœ¬ç”Ÿæˆ(éœ€proæ¨¡å‹) |
| **Poem** | è¯—æ­Œåˆ›ä½œ | ä¸å¸¸ç”¨,ä½†å­˜åœ¨ | Geminiè¯—æ­Œç”Ÿæˆ |

#### **Writeå·¥å…·çš„ä¸‰ç§æ¨¡å¼è¯¦è§£**
```javascript
// Auto Write - è‡ªåŠ¨ç»­å†™
const autoWritePrompt = `
åŸºäºä»¥ä¸‹å†…å®¹è‡ªç„¶ç»­å†™:
${previousText}

Story Bible: ${storyBible}
`;

// Guided Write - å¼•å¯¼ç»­å†™
const guidedWritePrompt = `
åŸºäºä»¥ä¸‹å†…å®¹å’Œç”¨æˆ·æŒ‡ç¤ºç»­å†™:
${previousText}

ç”¨æˆ·æŒ‡ç¤º: ${userGuidance}
Story Bible: ${storyBible}
`;

// Tone Shift - è¯­æ°”è½¬æ¢
const toneShiftPrompt = `
ä»¥${selectedTone}çš„è¯­æ°”ç»­å†™:
${previousText}

å¯é€‰è¯­æ°”: ç´§å¼ /è½»æ¾/æµªæ¼«/å¹½é»˜/æ‚²ä¼¤/ç¥ç§˜
`;
```

---

### **ä¸‰ã€é«˜çº§åŠŸèƒ½ - 95%å¯å¤åˆ»**

| åŠŸèƒ½ | æè¿° | å¤åˆ»éš¾åº¦ | è¯´æ˜ |
|------|------|----------|------|
| **Canvas** | å¯è§†åŒ–å¤§çº²ç”»æ¿ | â­â­â­â­ å›°éš¾ | æ‹–æ‹½å¼å¡ç‰‡ç³»ç»Ÿ,å¯ç”¨React Flowå®ç° |
| **Visualize** | æ ¹æ®æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡ | â­â­â­â­ å›°éš¾ | éœ€é›†æˆImagen/DALL-E,éæ ¸å¿ƒåŠŸèƒ½ |
| **Plugins** | è‡ªå®šä¹‰å·¥å…·ç³»ç»Ÿ | â­â­â­â­â­ å¾ˆéš¾ | è§ä¸‹æ–¹ä¸“é—¨è¯´æ˜ |
| **My Voice** | é£æ ¼å­¦ä¹  | â­â­â­â­ å›°éš¾ | Geminiå¯é€šè¿‡few-shotå­¦ä¹ æ¨¡ä»¿ |
| **Chat** | AIå¯¹è¯åŠ©æ‰‹ | â­â­ ä¸­ç­‰ | æ ‡å‡†èŠå¤©ç•Œé¢ + Gemini |
| **Quick Edit** | é€‰ä¸­æ–‡æœ¬å¿«é€Ÿç¼–è¾‘ | â­â­ ä¸­ç­‰ | å³é”®èœå• + Gemini |
| **Selection Menu** | é€‰ä¸­æ–‡æœ¬å·¥å…·æ  | â­ ç®€å• | æµ®åŠ¨å·¥å…·æ UI |
| **POV & Tense** | è§†è§’å’Œæ—¶æ€è®¾ç½® | â­ ç®€å• | ä¸‹æ‹‰é€‰æ‹©å™¨ |
| **Chapter Continuity** | ç« èŠ‚è¿ç»­æ€§ | â­â­ ä¸­ç­‰ | å¼•ç”¨å‰æ–‡å†…å®¹åˆ°Prompt |
| **Series Support** | ç³»åˆ—å°è¯´æ”¯æŒ | â­â­â­ å¤æ‚ | æ–‡ä»¶å¤¹ç³»ç»Ÿ + å…±äº«Story Bible |
| **Import Novel** | å¯¼å…¥å·²æœ‰å°è¯´ | â­â­â­ å¤æ‚ | æ–‡ä»¶è§£æ + AIæå–ä¿¡æ¯ |
| **History** | ç”Ÿæˆå†å²è®°å½• | â­â­ ä¸­ç­‰ | æœ¬åœ°å­˜å‚¨ + å¡ç‰‡å±•ç¤º |
| **Saliency Engine** | æ™ºèƒ½ä¸Šä¸‹æ–‡ç­›é€‰ | â­â­â­ å¤æ‚ | AIåˆ¤æ–­å“ªäº›è§’è‰²/å…ƒç´ ç›¸å…³ |

---

### **å››ã€Pluginsç³»ç»Ÿè¯¦è§£ - æ ¸å¿ƒç«äº‰åŠ›**

**Sudowriteçš„Pluginsæ˜¯å…¶æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€,ç¤¾åŒºå·²æœ‰1000+æ’ä»¶**

#### **æ’ä»¶èƒ½åšä»€ä¹ˆ?**
1. **ç”Ÿæˆæ–‡æœ¬** - æŒ‰ç‰¹å®šæ ¼å¼/é£æ ¼ç”Ÿæˆå†…å®¹
2. **è½¬æ¢æ–‡æœ¬** - æ”¹å†™/ç¿»è¯‘/æ ¼å¼è½¬æ¢
3. **åˆ†ææ–‡æœ¬** - åé¦ˆ/è¯„åˆ†/æ£€æŸ¥ä¸€è‡´æ€§

#### **æ’ä»¶ç³»ç»Ÿæ ¸å¿ƒæœºåˆ¶**
```javascript
// æ’ä»¶æ•°æ®ç»“æ„
const Plugin = {
  id: string,
  name: string,
  description: string,
  category: 'writing' | 'editing' | 'analysis' | 'worldbuilding' | 'character',
  creator: string,
  visibility: 'public' | 'unlisted',
  
  // æ ¸å¿ƒé…ç½®
  instruction: string,  // AIæŒ‡ä»¤(ç”¨æˆ·ç”¨è‡ªç„¶è¯­è¨€æè¿°)
  
  // é«˜çº§é…ç½®
  enableStoryBible: boolean,
  storyBibleFields: ['genre', 'characters', 'synopsis', ...],
  
  // å˜é‡ç³»ç»Ÿ
  variables: {
    "{{selected_text}}": "ç”¨æˆ·é€‰ä¸­çš„æ–‡æœ¬",
    "{{previous_text}}": "å…‰æ ‡å‰1000å­—",
    "{{genre}}": "Story Bibleçš„ä½“è£",
    "{{characters}}": "ç›¸å…³è§’è‰²ä¿¡æ¯",
    "{{synopsis}}": "æ•…äº‹æ¦‚è¦",
    "{{braindump}}": "çµæ„Ÿå€¾å€’",
    "{{outline}}": "å¤§çº²ä¿¡æ¯",
    "{{previous_document_text}}": "å‰ä¸€ç« å…¨æ–‡",
    // ... 20+ä¸ªå†…ç½®å˜é‡
  },
  
  // è¾“å‡ºé…ç½®
  outputType: 'single' | 'multiple',  // å•ä¸ª/å¤šä¸ªå¡ç‰‡
  model: 'muse' | 'gpt4' | 'claude' | 'gemini',
  temperature: 0.8,
  maxTokens: 1024
}

// æ’ä»¶æ‰§è¡Œæµç¨‹
async function executePlugin(plugin, context) {
  // 1. æ›¿æ¢å˜é‡
  let prompt = plugin.instruction;
  for (const [variable, value] of Object.entries(context)) {
    prompt = prompt.replace(variable, value);
  }
  
  // 2. æ·»åŠ Story Bible
  if (plugin.enableStoryBible) {
    prompt = addStoryBibleContext(prompt, plugin.storyBibleFields);
  }
  
  // 3. è°ƒç”¨AI
  const result = await geminiService.generate(prompt, {
    temperature: plugin.temperature,
    maxTokens: plugin.maxTokens
  });
  
  // 4. è¿”å›ç»“æœ
  return result;
}
```

#### **æ’ä»¶ç¤ºä¾‹**

**ç¤ºä¾‹1: å¯¹è¯æ¶¦è‰²æ’ä»¶**
```
åç§°: å¯¹è¯æ¶¦è‰²å¤§å¸ˆ
æŒ‡ä»¤: è¯·æ”¹å†™ä»¥ä¸‹å¯¹è¯,ä½¿å…¶æ›´åŠ ç”ŸåŠ¨è‡ªç„¶:
- å¢åŠ è¯­æ°”è¯å’Œåœé¡¿
- æ·»åŠ è‚¢ä½“è¯­è¨€æå†™
- ç¬¦åˆäººç‰©æ€§æ ¼

é€‰ä¸­æ–‡æœ¬: {{selected_text}}
è§’è‰²ä¿¡æ¯: {{characters}}

è¾“å‡º3ä¸ªç‰ˆæœ¬ã€‚
```

**ç¤ºä¾‹2: æƒ…èŠ‚ä¸€è‡´æ€§æ£€æŸ¥**
```
åç§°: æƒ…èŠ‚æ¼æ´æ£€æµ‹å™¨
æŒ‡ä»¤: è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹æ–‡æœ¬,æ£€æŸ¥æ˜¯å¦æœ‰æƒ…èŠ‚ä¸ä¸€è‡´çš„åœ°æ–¹:
- äººç‰©æ€§æ ¼æ˜¯å¦å‰åçŸ›ç›¾
- æ—¶é—´çº¿æ˜¯å¦åˆç†
- äººç‰©ä½ç½®å˜åŒ–æ˜¯å¦è¿è´¯

é€‰ä¸­æ–‡æœ¬: {{selected_text}}
æ•…äº‹æ¦‚è¦: {{synopsis}}
è§’è‰²è®¾å®š: {{characters}}

åˆ—å‡ºæ‰€æœ‰å‘ç°çš„é—®é¢˜,æ¯ä¸ªé—®é¢˜åŒ…å«:ä½ç½®ã€æè¿°ã€å»ºè®®ä¿®æ”¹ã€‚
```

**ç¤ºä¾‹3: æ­¦ä¾ åŠ¨ä½œåœºé¢ç”Ÿæˆ(ä¸­æ–‡ç‰¹è‰²)**
```
åç§°: æ­¦ä¾ æ‰“æ–—ç”Ÿæˆå™¨
æŒ‡ä»¤: åŸºäºä»¥ä¸‹è®¾å®šç”Ÿæˆä¸€ä¸ªç²¾å½©çš„æ­¦ä¾ æ‰“æ–—åœºæ™¯(300å­—):

äººç‰©1: {{character1}}
äººç‰©2: {{character2}}
åœ°ç‚¹: {{location}}
èµ·å› : {{conflict}}

è¦æ±‚:
- æå†™æ‹›å¼ç»†èŠ‚(è½»åŠŸã€å†…åŠ›ã€å…µå™¨)
- ä½“ç°äººç‰©æ€§æ ¼å’Œæ­¦åŠŸé£æ ¼
- æœ‰æ¥æœ‰å›,å¼ å¼›æœ‰åº¦
- ç¬¦åˆæ­¦ä¾ å°è¯´è¯­è¨€é£æ ¼
```

#### **æˆ‘ä»¬å¦‚ä½•å®ç°Plugins?**

**æ–¹æ¡ˆA: ç®€åŒ–ç‰ˆ(MVP)**
- é¢„è®¾20-30ä¸ªå¸¸ç”¨æ’ä»¶
- ç”¨æˆ·ä¸èƒ½è‡ªå·±åˆ›å»º
- æ¯ä¸ªæ’ä»¶å°±æ˜¯ä¸€ä¸ªé¢„å®šä¹‰çš„Promptæ¨¡æ¿

**æ–¹æ¡ˆB: å®Œæ•´ç‰ˆ(ç»ˆæç›®æ ‡)**
- å…è®¸ç”¨æˆ·ç”¨è‡ªç„¶è¯­è¨€åˆ›å»ºæ’ä»¶
- æ”¯æŒå˜é‡ç³»ç»Ÿ
- æ’ä»¶å¸‚åœº/ç¤¾åŒº
- å…¬å¼€/ç§æœ‰æ’ä»¶

**æ¨è: å…ˆåšæ–¹æ¡ˆA,åç»­å‡çº§åˆ°æ–¹æ¡ˆB**

---

### **äº”ã€å¤šæ¨¡å‹æ”¯æŒ - Sudowriteçš„ç‹¬ç‰¹ä¼˜åŠ¿**

Sudowriteæ”¯æŒå¤šä¸ªAIæ¨¡å‹,ç”¨æˆ·å¯æ ¹æ®éœ€æ±‚é€‰æ‹©:

| æ¨¡å‹ | ç‰¹ç‚¹ | æˆæœ¬ | é€‚ç”¨åœºæ™¯ | æˆ‘ä»¬çš„å¯¹åº” |
|------|------|------|----------|-----------|
| **Muse 1.5** | ä¸“ä¸ºå°è¯´è®­ç»ƒ,è´¨é‡æœ€é«˜ | è´µ | æ ¸å¿ƒå†™ä½œ | âŒ æ— æ³•å¤åˆ»(ä¸“æœ‰) |
| GPT-5 | åˆ›æ„å¼º,å¯¹è¯å¥½ | è´µ | å¯¹è¯åœºæ™¯ | Gemini 2.0 Flash |
| GPT-4 | å¹³è¡¡æ€§å¥½ | ä¸­ç­‰ | é€šç”¨å†™ä½œ | Gemini 1.5 Pro |
| Claude 3.5 | é€»è¾‘å¼º,æ–‡å­¦æ€§å¥½ | ä¸­ç­‰ | æƒ…èŠ‚æ¨ç† | Gemini 1.5 Pro |
| GPT-3.5 | ä¾¿å®œå¿«é€Ÿ | ä¾¿å®œ | å¤´è„‘é£æš´ | Gemini 1.5 Flash |
| DeepSeek | ä¾¿å®œ,ä¸­æ–‡å¥½ | å¾ˆä¾¿å®œ | ä¸­æ–‡å†™ä½œ | âœ… å¯ç›´æ¥é›†æˆ |

**æˆ‘ä»¬çš„å¤šæ¨¡å‹ç­–ç•¥:**
1. **ä¸»åŠ›**: Gemini 1.5 Pro(è´¨é‡) + Flash(é€Ÿåº¦)
2. **è¾…åŠ©**: DeepSeek(ä¸­æ–‡ä¼˜åŒ–)
3. **å¯é€‰**: Claude API / GPT API(ç”¨æˆ·è‡ªå·±é…ç½®)

---

### **å…­ã€ç•Œé¢ä¸äº¤äº’ - ç»†èŠ‚å†³å®šæˆè´¥**

#### **1. ç¼–è¾‘å™¨åŠŸèƒ½**
- âœ… å¯Œæ–‡æœ¬ç¼–è¾‘(ç²—ä½“/æ–œä½“/ä¸‹åˆ’çº¿)
- âœ… AIç”Ÿæˆæ–‡æœ¬é«˜äº®æ˜¾ç¤º(ç´«è‰²)
- âœ… å­—æ•°/å­—ç¬¦ç»Ÿè®¡
- âœ… è‡ªåŠ¨ä¿å­˜
- âœ… æ’¤é”€/é‡åš
- âœ… æŸ¥æ‰¾/æ›¿æ¢
- âœ… å¯¼å‡º(DOCX/PDF/TXT)

#### **2. Historyé¢æ¿**
- âœ… æ‰€æœ‰AIç”Ÿæˆçš„"å¡ç‰‡"
- âœ… å¯æ”¶è—(æ˜Ÿæ ‡)
- âœ… å¯æœç´¢
- âœ… å¯å¯¹æ¯”å¤šä¸ªç‰ˆæœ¬
- âœ… ä¸€é”®æ’å…¥

#### **3. å·¥å…·æ å¸ƒå±€**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ç»­å†™â–¼] [æ”¹å†™] [æå†™] [æ‰©å±•] [å¤´è„‘é£æš´] â”‚
â”‚                                        â”‚
â”‚  Auto  Guided  Tone                    â”‚
â”‚  âœ¨     â†”ï¸      ğŸ¥¸                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»â–¼å±•å¼€å­èœå•
æ‚¬åœæ˜¾ç¤ºæç¤º
å¿«æ·é”®æç¤º
```

#### **4. é€‰ä¸­æ–‡æœ¬å·¥å…·æ (æµ®åŠ¨)**
```
ç”¨æˆ·é€‰ä¸­æ–‡æœ¬åè‡ªåŠ¨æ˜¾ç¤º:

  [æ”¹å†™] [æå†™] [æ‰©å±•] [å‹ç¼©] [æ›´å¤šâ–¼]
     â†‘ æµ®åŠ¨åœ¨é€‰ä¸­æ–‡æœ¬ä¸Šæ–¹
```

#### **5. Story Bibleä¾§è¾¹æ **
```
â”Œâ”€ Story Bible â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“š Braindump     [ç¼–è¾‘] â”‚
â”‚ ğŸ­ Genre & Style [ç¼–è¾‘] â”‚
â”‚ ğŸ“– Synopsis      [ç”Ÿæˆ] â”‚
â”‚ ğŸ‘¤ Characters    [+æ–°å¢]â”‚
â”‚   â”œâ”€ ä¸»è§’A             â”‚
â”‚   â”œâ”€ åæ´¾B             â”‚
â”‚   â””â”€ é…è§’C             â”‚
â”‚ ğŸŒ Worldbuilding [+æ–°å¢]â”‚
â”‚ ğŸ“ Outline       [ç¼–è¾‘] â”‚
â”‚ ğŸ¬ Scenes        [ç¼–è¾‘] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ å®Œæ•´æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### **æ ¸å¿ƒæŠ€æœ¯æ ˆ**

```json
{
  "å‰ç«¯æ¡†æ¶": "React 18 + TypeScript",
  "UIåº“": "Tailwind CSS + shadcn/ui",
  "å¯Œæ–‡æœ¬ç¼–è¾‘å™¨": "Lexical (Metaå¼€æº,Facebookç”¨çš„)",
  "æ‹–æ‹½": "dnd-kit",
  "çŠ¶æ€ç®¡ç†": "Zustand",
  "è·¯ç”±": "React Router",
  "å›¾æ ‡": "Lucide React",
  "Canvaså¯è§†åŒ–": "React Flow",
  "å­˜å‚¨": "window.storage API (Claude Artifacts) æˆ– IndexedDB",
  "AIé›†æˆ": "Gemini API"
}
```

### **æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ**

```javascript
// ä½¿ç”¨Claude Artifactsçš„æŒä¹…åŒ–å­˜å‚¨
// æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹å­˜å‚¨

// é¡¹ç›®åˆ—è¡¨
await window.storage.set('projects-list', JSON.stringify(projectsList), false);

// å•ä¸ªé¡¹ç›®
await window.storage.set(`project:${projectId}`, JSON.stringify(project), false);

// Story Bible
await window.storage.set(`story-bible:${projectId}`, JSON.stringify(storyBible), false);

// æ–‡æ¡£å†…å®¹
await window.storage.set(`document:${docId}`, content, false);

// Historyè®°å½•
await window.storage.set(`history:${projectId}`, JSON.stringify(history), false);

// æ’ä»¶(å¯é€‰å…±äº«)
await window.storage.set(`plugin:${pluginId}`, JSON.stringify(plugin), true);  // shared
```

### **Gemini APIå®Œæ•´å°è£…**

```javascript
// services/gemini.js
import { GoogleGenerativeAI } from "@google/generative-ai";

class GeminiService {
  constructor(apiKey) {
    this.ai = new GoogleGenerativeAI(apiKey);
    this.defaultConfig = {
      temperature: 0.8,
      topK: 40,
      topP: 0.95,
      maxOutputTokens: 2048
    };
  }

  // è·å–æ¨¡å‹
  getModel(fast = false) {
    return this.ai.getGenerativeModel({
      model: fast ? "gemini-1.5-flash" : "gemini-1.5-pro",
      generationConfig: this.defaultConfig
    });
  }

  // é€šç”¨ç”Ÿæˆ
  async generate(prompt, config = {}) {
    const model = this.getModel(config.fast);
    const result = await model.generateContent(prompt);
    return result.response.text();
  }

  // æµå¼ç”Ÿæˆ(å®æ—¶æ˜¾ç¤º)
  async *generateStream(prompt, config = {}) {
    const model = this.getModel(config.fast);
    const result = await model.generateContentStream(prompt);
    
    for await (const chunk of result.stream) {
      yield chunk.text();
    }
  }

  // æ„å»ºå®Œæ•´Prompt
  buildPrompt(template, context, storyBible) {
    let prompt = template;
    
    // æ›¿æ¢ä¸Šä¸‹æ–‡å˜é‡
    for (const [key, value] of Object.entries(context)) {
      prompt = prompt.replace(`{{${key}}}`, value);
    }
    
    // æ·»åŠ Story Bible
    if (storyBible.enabled) {
      prompt = `
ã€Story Bibleä¿¡æ¯ã€‘
ä½“è£: ${storyBible.genre}
é£æ ¼: ${storyBible.style}
æ¦‚è¦: ${storyBible.synopsis}

${storyBible.includeCharacters ? `è§’è‰²: ${JSON.stringify(storyBible.characters)}` : ''}

ã€å†™ä½œä»»åŠ¡ã€‘
${prompt}
`;
    }
    
    // æ·»åŠ ä¸­æ–‡ä¼˜åŒ–æŒ‡ä»¤
    prompt += `\n
ã€é‡è¦è¦æ±‚ã€‘
1. ä½¿ç”¨åœ°é“è‡ªç„¶çš„ä¸­æ–‡è¡¨è¾¾
2. é¿å…"çªç„¶"ã€"åŸæ¥"ã€"ç«Ÿç„¶"ç­‰é™ˆè¯æ»¥è°ƒ
3. ç¬¦åˆ${storyBible.genre}ä½“è£çš„è¯­è¨€é£æ ¼
4. å±•ç¤ºè€Œéå‘ŠçŸ¥(Show, Don't Tell)
`;
    
    return prompt;
  }

  // ç»­å†™åŠŸèƒ½
  async write(mode, context, storyBible) {
    const templates = {
      auto: AUTO_WRITE_TEMPLATE,
      guided: GUIDED_WRITE_TEMPLATE,
      toneShift: TONE_SHIFT_TEMPLATE
    };
    
    const prompt = this.buildPrompt(templates[mode], context, storyBible);
    return await this.generate(prompt);
  }

  // æ”¹å†™åŠŸèƒ½
  async rewrite(text, instruction, storyBible) {
    const prompt = this.buildPrompt(REWRITE_TEMPLATE, {
      text,
      instruction
    }, storyBible);
    
    const result = await this.generate(prompt);
    return JSON.parse(result);  // è¿”å›å¤šä¸ªç‰ˆæœ¬
  }

  // æå†™å¢å¼º
  async describe(text, context, storyBible) {
    const prompt = this.buildPrompt(DESCRIBE_TEMPLATE, {
      text,
      context
    }, storyBible);
    
    const result = await this.generate(prompt);
    return JSON.parse(result);
  }

  // è§’è‰²ç”Ÿæˆ
  async generateCharacter(synopsis, genre, count = 1) {
    const prompt = `åŸºäºä»¥ä¸‹æ•…äº‹æ¦‚è¦,ç”Ÿæˆ${count}ä¸ªç«‹ä½“çš„è§’è‰²ã€‚

æ•…äº‹æ¦‚è¦: ${synopsis}
ä½“è£: ${genre}

å¯¹æ¯ä¸ªè§’è‰²,ç”Ÿæˆ:
- å§“å(ç¬¦åˆ${genre}é£æ ¼)
- å¹´é¾„
- å¤–è²Œ(3-5ä¸ªç‰¹å¾)
- æ€§æ ¼(MBTI + 5ä¸ªå…³é”®è¯)
- èƒŒæ™¯æ•…äº‹(100å­—)
- æ ¸å¿ƒåŠ¨æœº
- ä¸»è¦å†²çª

è¾“å‡ºä¸ºJSONæ•°ç»„æ ¼å¼ã€‚è¦æ±‚åŸåˆ›æ€§é«˜,é¿å…åˆ»æ¿å°è±¡ã€‚`;

    const result = await this.generate(prompt, { fast: false });
    return JSON.parse(result);
  }

  // åœºæ™¯ç”Ÿæˆ
  async generateScene(scene, storyBible) {
    const prompt = this.buildPrompt(SCENE_TEMPLATE, {
      description: scene.description,
      pov: scene.pov,
      tense: scene.tense,
      pace: scene.pace,
      beats: scene.beats.join('\n'),
      extraInstructions: scene.extraInstructions
    }, storyBible);
    
    return await this.generate(prompt, { fast: false });
  }

  // å¤´è„‘é£æš´
  async brainstorm(topic, category, context, storyBible) {
    const prompt = this.buildPrompt(BRAINSTORM_TEMPLATE, {
      topic,
      category,
      context
    }, storyBible);
    
    const result = await this.generate(prompt, { fast: true });
    return JSON.parse(result);
  }

  // æƒ…èŠ‚è½¬æŠ˜
  async generateTwist(synopsis, storyBible) {
    const prompt = `åŸºäºä»¥ä¸‹æ•…äº‹æ¢—æ¦‚,ç”Ÿæˆ5ä¸ªæ„å¤–ä¸”åˆç†çš„æƒ…èŠ‚è½¬æŠ˜ç‚¹ã€‚

æ•…äº‹æ¢—æ¦‚: ${synopsis}
ä½“è£: ${storyBible.genre}

æ¯ä¸ªè½¬æŠ˜åŒ…å«:
- è½¬æŠ˜ç‚¹æè¿°(50å­—)
- å¦‚ä½•é“ºå«(50å­—)
- å½±å“å’Œåæœ(50å­—)

è¦æ±‚:
- å‡ºä¹æ„æ–™ä½†åˆç†
- ç¬¦åˆä½“è£å’Œäººç‰©æ€§æ ¼
- é¿å…è€å¥—çš„"åŸæ¥ä»–æ˜¯..."ç±»å‹

è¾“å‡ºJSONæ•°ç»„ã€‚`;

    const result = await this.generate(prompt);
    return JSON.parse(result);
  }
}

export const gemini = new GeminiService(GEMINI_API_KEY);
```

### **Promptæ¨¡æ¿åº“**

```javascript
// prompts/templates.js

export const AUTO_WRITE_TEMPLATE = `
è¯·è‡ªç„¶æµç•…åœ°ç»­å†™ä»¥ä¸‹æ–‡æœ¬ã€‚

ã€å·²æœ‰æ–‡æœ¬ã€‘
{{previous_text}}

ã€ç»­å†™è¦æ±‚ã€‘
1. ç”Ÿæˆçº¦300å­—
2. ä¿æŒå‰æ–‡é£æ ¼å’Œè¯­æ°”
3. ç¬¦åˆäººç‰©æ€§æ ¼
4. æ¨è¿›æƒ…èŠ‚æˆ–æ·±åŒ–æå†™
5. ä¸è¦ç”Ÿç¡¬è½¬æŠ˜
6. è‡ªç„¶æ”¶å°¾,ç•™æœ‰ä½™åœ°

ç›´æ¥ç»­å†™,ä¸è¦å¼€åœºç™½ã€‚
`;

export const GUIDED_WRITE_TEMPLATE = `
è¯·æ ¹æ®ç”¨æˆ·æŒ‡ç¤ºç»­å†™ä»¥ä¸‹æ–‡æœ¬ã€‚

ã€å·²æœ‰æ–‡æœ¬ã€‘
{{previous_text}}

ã€ç”¨æˆ·æŒ‡ç¤ºã€‘
{{user_guidance}}

ã€ç»­å†™è¦æ±‚ã€‘
1. ä¸¥æ ¼æŒ‰ç…§ç”¨æˆ·æŒ‡ç¤ºå‘å±•æƒ…èŠ‚
2. ç”Ÿæˆçº¦300å­—
3. ä¿æŒé£æ ¼ä¸€è‡´
4. è‡ªç„¶è¡”æ¥

ç›´æ¥ç»­å†™ã€‚
`;

export const TONE_SHIFT_TEMPLATE = `
è¯·ä»¥{{tone}}çš„è¯­æ°”ç»­å†™ä»¥ä¸‹æ–‡æœ¬ã€‚

ã€å·²æœ‰æ–‡æœ¬ã€‘
{{previous_text}}

ã€è¯­æ°”è¯´æ˜ã€‘
- ç´§å¼ : çŸ­å¥ã€å¿«èŠ‚å¥ã€æ‚¬å¿µ
- è½»æ¾: å¹½é»˜ã€éšæ„ã€èˆ’ç¼“
- æµªæ¼«: ç»†è…»ã€æ„Ÿæ€§ã€è¯—æ„
- ç¥ç§˜: æš—ç¤ºã€éšå–»ã€ä¸ç¡®å®š

ç”Ÿæˆçº¦300å­—,å®Œå…¨ä½“ç°æ‰€é€‰è¯­æ°”ã€‚
`;

export const REWRITE_TEMPLATE = `
è¯·æ”¹å†™ä»¥ä¸‹æ–‡æœ¬,{{instruction}}ã€‚

ã€åŸæ–‡ã€‘
{{text}}

ã€æ”¹å†™è¦æ±‚ã€‘
1. ä¿æŒæ ¸å¿ƒæ„æ€ä¸å˜
2. æä¾›3ä¸ªä¸åŒé£æ ¼çš„ç‰ˆæœ¬
3. æ¯ä¸ªç‰ˆæœ¬çº¦{{length}}å­—
4. æ ‡æ³¨æ¯ä¸ªç‰ˆæœ¬çš„ç‰¹ç‚¹

è¾“å‡ºJSONæ ¼å¼:
[
  {
    "version": 1,
    "style": "ç®€æ´ç‰ˆ",
    "text": "..."
  },
  ...
]
`;

export const DESCRIBE_TEMPLATE = `
è¯·ä¸ºä»¥ä¸‹åœºæ™¯ç‰‡æ®µæ·»åŠ ä¸°å¯Œçš„æ„Ÿå®˜æå†™ã€‚

ã€åŸæ–‡ã€‘
{{text}}

ã€åœºæ™¯èƒŒæ™¯ã€‘
{{context}}

ã€æå†™è¦æ±‚ã€‘
1. äº”æ„Ÿæå†™:è§†è§‰ã€å¬è§‰ã€å—…è§‰ã€è§¦è§‰ã€å‘³è§‰
2. åˆ¶é€ æ²‰æµ¸æ„Ÿ
3. ä¸æ”¹å˜åŸæœ‰æƒ…èŠ‚
4. é¿å…è¿‡åº¦åä¸½
5. æä¾›2ä¸ªç‰ˆæœ¬ä¾›é€‰æ‹©

è¾“å‡ºJSONæ•°ç»„æ ¼å¼ã€‚
`;

export const SCENE_TEMPLATE = `
ä½ æ˜¯å°è¯´å†™ä½œä¸“å®¶ã€‚è¯·åŸºäºä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆåœºæ™¯æ–‡æœ¬ã€‚

ã€åœºæ™¯è¦æ±‚ã€‘
æè¿°: {{description}}
è§†è§’: {{pov}}
æ—¶æ€: {{tense}}
èŠ‚å¥: {{pace}}

ã€æƒ…èŠ‚è¦ç‚¹ã€‘
{{beats}}

ã€é¢å¤–æŒ‡ä»¤ã€‘
{{extraInstructions}}

ã€å†™ä½œè¦æ±‚ã€‘
1. ç”Ÿæˆ300-500å­—çš„åœºæ™¯æ–‡æœ¬
2. å±•ç°äººç‰©æ€§æ ¼,ä¸è¦å¹³é“ºç›´å™
3. ä½¿ç”¨"å±•ç¤ºè€Œéå‘ŠçŸ¥"(Show, Don't Tell)
4. è‡ªç„¶èå…¥ç¯å¢ƒå’Œæ„Ÿå®˜æå†™
5. ç¬¦åˆäººç‰©æ€§æ ¼å’Œæ•…äº‹é€»è¾‘
6. è¯­è¨€ç”ŸåŠ¨ä½†ä¸æµ®å¤¸

ç›´æ¥è¾“å‡ºåœºæ™¯æ–‡æœ¬ã€‚
`;

export const BRAINSTORM_TEMPLATE = `
è¯·ä¸ºä»¥ä¸‹ä¸»é¢˜ç”Ÿæˆ{{category}}åˆ›æ„ã€‚

ã€ä¸»é¢˜ã€‘
{{topic}}

ã€èƒŒæ™¯ã€‘
{{context}}

ã€åˆ›æ„ç±»åˆ«è¯´æ˜ã€‘
- è§’è‰²åˆ›æ„: æ–°è§’è‰²ã€è§’è‰²å‘å±•æ–¹å‘
- æƒ…èŠ‚è½¬æŠ˜: æ„å¤–äº‹ä»¶ã€å†²çªå‡çº§
- å¯¹è¯çµæ„Ÿ: å…³é”®å°è¯ã€å¯¹è¯åœºæ™¯
- ä¸–ç•Œè§‚: åœ°ç‚¹ã€è§„åˆ™ã€å†å²
- å†²çªè®¾è®¡: å¤–éƒ¨å†²çªã€å†…å¿ƒæŒ£æ‰

ç”Ÿæˆ10ä¸ªåˆ›æ„,æ¯ä¸ªåŒ…å«ç®€çŸ­è¯´æ˜(30å­—)ã€‚

è¾“å‡ºJSONæ•°ç»„:
[
  {
    "idea": "...",
    "description": "..."
  },
  ...
]
`;
```

---

## ğŸ¨ UIç»„ä»¶å®ç°ç¤ºä¾‹

### **Story Bibleé¢æ¿ç»„ä»¶**

```jsx
// components/StoryBible/StoryBiblePanel.jsx
import { useState } from 'react';
import { useStoryBible } from '@/contexts/StoryBibleContext';
import { Button } from '@/components/ui/button';
import { Textarea } from '@/components/ui/textarea';
import { BookOpen, Users, Globe, List, Film } from 'lucide-react';

export function StoryBiblePanel() {
  const { storyBible, updateField, generateSynopsis } = useStoryBible();
  const [activeTab, setActiveTab] = useState('braindump');
  const [loading, setLoading] = useState(false);

  const tabs = [
    { id: 'braindump', label: 'çµæ„Ÿ', icon: BookOpen },
    { id: 'synopsis', label: 'æ¦‚è¦', icon: BookOpen },
    { id: 'characters', label: 'è§’è‰²', icon: Users },
    { id: 'worldbuilding', label: 'ä¸–ç•Œè§‚', icon: Globe },
    { id: 'outline', label: 'å¤§çº²', icon: List },
    { id: 'scenes', label: 'åœºæ™¯', icon: Film }
  ];

  const handleGenerate = async () => {
    setLoading(true);
    try {
      await generateSynopsis();
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="w-80 border-l bg-gray-50 flex flex-col">
      {/* æ ‡ç­¾æ  */}
      <div className="flex border-b overflow-x-auto">
        {tabs.map(tab => (
          <button
            key={tab.id}
            onClick={() => setActiveTab(tab.id)}
            className={`px-4 py-2 flex items-center gap-2 whitespace-nowrap ${
              activeTab === tab.id 
                ? 'border-b-2 border-blue-500 text-blue-600' 
                : 'text-gray-600'
            }`}
          >
            <tab.icon className="w-4 h-4" />
            {tab.label}
          </button>
        ))}
      </div>

      {/* å†…å®¹åŒº */}
      <div className="flex-1 overflow-y-auto p-4">
        {activeTab === 'braindump' && (
          <BraindumpSection 
            value={storyBible.braindump}
            onChange={(value) => updateField('braindump', value)}
          />
        )}
        
        {activeTab === 'synopsis' && (
          <SynopsisSection
            value={storyBible.synopsis}
            onChange={(value) => updateField('synopsis', value)}
            onGenerate={handleGenerate}
            loading={loading}
          />
        )}
        
        {activeTab === 'characters' && (
          <CharactersSection />
        )}
        
        {/* ... å…¶ä»–æ ‡ç­¾å†…å®¹ */}
      </div>
    </div>
  );
}

// BraindumpåŒºåŸŸ
function BraindumpSection({ value, onChange }) {
  return (
    <div className="space-y-4">
      <div>
        <h3 className="font-medium mb-2">çµæ„Ÿå€¾å€’ ğŸ’¡</h3>
        <p className="text-sm text-gray-600 mb-3">
          éšæ„è®°å½•ä½ çš„æ•…äº‹æƒ³æ³•,ä¸é™æ ¼å¼ã€‚
        </p>
      </div>
      
      <Textarea
        value={value}
        onChange={(e) => onChange(e.target.value)}
        placeholder="ä¾‹å¦‚: ä¸€ä¸ªå¹´è½»å¥³å­©å‘ç°è‡ªå·±å¯ä»¥è¿›å…¥åˆ«äººçš„æ¢¦å¢ƒ..."
        className="min-h-[300px]"
      />
      
      <div className="flex gap-2">
        <Button variant="outline" size="sm">
          Genre & Style
        </Button>
      </div>
    </div>
  );
}

// SynopsisåŒºåŸŸ
function SynopsisSection({ value, onChange, onGenerate, loading }) {
  return (
    <div className="space-y-4">
      <div className="flex justify-between items-center">
        <h3 className="font-medium">æ•…äº‹æ¦‚è¦ ğŸ“–</h3>
        <Button 
          onClick={onGenerate}
          disabled={loading}
          size="sm"
        >
          {loading ? 'ç”Ÿæˆä¸­...' : 'ç”Ÿæˆ'}
        </Button>
      </div>
      
      <Textarea
        value={value}
        onChange={(e) => onChange(e.target.value)}
        placeholder="3-5æ®µçš„æ•…äº‹æ‘˜è¦,AIå¯ä»¥è‡ªåŠ¨ç”Ÿæˆ..."
        className="min-h-[400px]"
      />
    </div>
  );
}
```

### **ç¼–è¾‘å™¨ç»„ä»¶(Lexical)**

```jsx
// components/Editor/WritingEditor.jsx
import { LexicalComposer } from '@lexical/react/LexicalComposer';
import { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';
import { ContentEditable } from '@lexical/react/LexicalContentEditable';
import { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';
import { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';
import LexicalErrorBoundary from '@lexical/react/LexicalErrorBoundary';

import { FloatingToolbar } from './FloatingToolbar';
import { EditorToolbar } from './EditorToolbar';

const theme = {
  paragraph: 'mb-2',
  text: {
    bold: 'font-bold',
    italic: 'italic',
    underline: 'underline'
  }
};

export function WritingEditor({ documentId }) {
  const initialConfig = {
    namespace: 'WritingEditor',
    theme,
    onError: (error) => console.error(error)
  };

  const handleChange = (editorState) => {
    editorState.read(() => {
      // ä¿å­˜å†…å®¹
      const json = editorState.toJSON();
      saveDocument(documentId, json);
    });
  };

  return (
    <div className="flex-1 flex flex-col">
      <LexicalComposer initialConfig={initialConfig}>
        {/* é¡¶éƒ¨å·¥å…·æ  */}
        <EditorToolbar />
        
        <div className="flex-1 overflow-y-auto p-8">
          <RichTextPlugin
            contentEditable={
              <ContentEditable className="outline-none min-h-full" />
            }
            placeholder={
              <div className="absolute top-8 left-8 text-gray-400 pointer-events-none">
                å¼€å§‹å†™ä½œ,æˆ–ä½¿ç”¨ä¸‹æ–¹çš„"ç»­å†™"æŒ‰é’®...
              </div>
            }
            ErrorBoundary={LexicalErrorBoundary}
          />
        </div>
        
        {/* é€‰ä¸­æ–‡æœ¬æµ®åŠ¨å·¥å…·æ  */}
        <FloatingToolbar />
        
        {/* å†å²è®°å½• */}
        <HistoryPlugin />
        
        {/* è‡ªåŠ¨ä¿å­˜ */}
        <OnChangePlugin onChange={handleChange} />
      </LexicalComposer>
    </div>
  );
}
```

### **å·¥å…·æ ç»„ä»¶**

```jsx
// components/Editor/EditorToolbar.jsx
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { 
  PenLine, 
  RotateCw, 
  Eye, 
  Maximize, 
  Lightbulb,
  Wand2 
} from 'lucide-react';

export function EditorToolbar() {
  const [writeMode, setWriteMode] = useState('auto');
  const [showWriteMenu, setShowWriteMenu] = useState(false);

  return (
    <div className="border-b p-2 flex items-center gap-2">
      {/* ç»­å†™æŒ‰é’®ç»„ */}
      <div className="relative">
        <Button
          variant="default"
          onClick={() => handleWrite('auto')}
          onMouseEnter={() => setShowWriteMenu(true)}
          onMouseLeave={() => setShowWriteMenu(false)}
        >
          <PenLine className="w-4 h-4 mr-2" />
          ç»­å†™
          <ChevronDown className="w-4 h-4 ml-1" />
        </Button>
        
        {/* ä¸‹æ‹‰èœå• */}
        {showWriteMenu && (
          <div className="absolute top-full left-0 mt-1 bg-white border rounded shadow-lg z-10">
            <button 
              className="px-4 py-2 hover:bg-gray-100 flex items-center gap-2 w-full"
              onClick={() => handleWrite('auto')}
            >
              <Sparkles className="w-4 h-4" />
              Auto - è‡ªåŠ¨ç»­å†™
            </button>
            <button 
              className="px-4 py-2 hover:bg-gray-100 flex items-center gap-2 w-full"
              onClick={() => handleWrite('guided')}
            >
              <ArrowRight className="w-4 h-4" />
              Guided - å¼•å¯¼ç»­å†™
            </button>
            <button 
              className="px-4 py-2 hover:bg-gray-100 flex items-center gap-2 w-full"
              onClick={() => handleWrite('tone')}
            >
              <Smile className="w-4 h-4" />
              Tone Shift - è¯­æ°”è½¬æ¢
            </button>
          </div>
        )}
      </div>

      <Button variant="outline">
        <RotateCw className="w-4 h-4 mr-2" />
        æ”¹å†™
      </Button>

      <Button variant="outline">
        <Eye className="w-4 h-4 mr-2" />
        æå†™
      </Button>

      <Button variant="outline">
        <Maximize className="w-4 h-4 mr-2" />
        æ‰©å±•
      </Button>

      <Button variant="outline">
        <Lightbulb className="w-4 h-4 mr-2" />
        å¤´è„‘é£æš´
      </Button>

      <div className="ml-auto flex items-center gap-4">
        <span className="text-sm text-gray-600">
          å­—æ•°: 3,247
        </span>
        <Button variant="ghost" size="sm">
          æ›´å¤šå·¥å…· â–¼
        </Button>
      </div>
    </div>
  );
}
```

---

## âœ… å®Œæ•´åŠŸèƒ½å¯¹æ¯”è¡¨

| åŠŸèƒ½ç±»åˆ« | SudowriteåŠŸèƒ½ | å¤åˆ»éš¾åº¦ | å®ç°æ–¹æ¡ˆ | çŠ¶æ€ |
|---------|---------------|----------|----------|------|
| **Story Bible** | | | | |
| â†’ Braindump | âœ“ | â­ | æ–‡æœ¬æ¡† | âœ… 100% |
| â†’ Genre & Style | âœ“ | â­ | é€‰æ‹©å™¨+æ–‡ä»¶ä¸Šä¼  | âœ… 100% |
| â†’ Synopsis | âœ“ | â­â­ | Geminiç”Ÿæˆ | âœ… 100% |
| â†’ Characters | âœ“ | â­â­â­ | CRUD+AIç”Ÿæˆ | âœ… 100% |
| â†’ Worldbuilding | âœ“ | â­â­â­ | å¡ç‰‡ç³»ç»Ÿ | âœ… 100% |
| â†’ Outline | âœ“ | â­â­â­ | å¯æ‹–æ‹½åˆ—è¡¨ | âœ… 100% |
| â†’ Scenes | âœ“ | â­â­â­ | åœºæ™¯å¡ç‰‡ | âœ… 100% |
| **å†™ä½œå·¥å…·** | | | | |
| â†’ Write (Auto) | âœ“ | â­â­ | Geminiç»­å†™ | âœ… 100% |
| â†’ Write (Guided) | âœ“ | â­â­ | Gemini+ç”¨æˆ·æŒ‡ç¤º | âœ… 100% |
| â†’ Write (Tone Shift) | âœ“ | â­â­ | Geminiè¯­æ°”è½¬æ¢ | âœ… 100% |
| â†’ Rewrite | âœ“ | â­â­ | Geminiæ”¹å†™ | âœ… 100% |
| â†’ Describe | âœ“ | â­â­ | Geminiæå†™å¢å¼º | âœ… 100% |
| â†’ Expand | âœ“ | â­â­ | Geminiæ‰©å±• | âœ… 100% |
| â†’ Shrink Ray | âœ“ | â­â­ | Geminiå‹ç¼© | âœ… 100% |
| â†’ Brainstorm | âœ“ | â­â­ | Geminiåˆ—è¡¨ç”Ÿæˆ | âœ… 100% |
| â†’ Twist | âœ“ | â­â­ | Geminiè½¬æŠ˜ç”Ÿæˆ | âœ… 100% |
| â†’ First Draft | âœ“ | â­â­â­ | Gemini Proé•¿æ–‡æœ¬ | âœ… 100% |
| **é«˜çº§åŠŸèƒ½** | | | | |
| â†’ Canvas | âœ“ | â­â­â­â­ | React Flow | âœ… 90% |
| â†’ Plugins (é¢„è®¾) | âœ“ | â­â­â­ | é¢„å®šä¹‰æ¨¡æ¿ | âœ… 100% |
| â†’ Plugins (è‡ªå®šä¹‰) | âœ“ | â­â­â­â­â­ | è‡ªç„¶è¯­è¨€ç”Ÿæˆ | ğŸ”„ 80% |
| â†’ My Voice | âœ“ | â­â­â­â­ | Few-shotå­¦ä¹  | âœ… 90% |
| â†’ Chat | âœ“ | â­â­ | èŠå¤©ç•Œé¢ | âœ… 100% |
| â†’ Quick Edit | âœ“ | â­â­ | å³é”®èœå• | âœ… 100% |
| â†’ Visualize | âœ“ | â­â­â­â­ | å›¾åƒç”ŸæˆAPI | ğŸ”„ 50% |
| â†’ POV & Tense | âœ“ | â­ | é€‰æ‹©å™¨ | âœ… 100% |
| â†’ Chapter Continuity | âœ“ | â­â­ | å¼•ç”¨å‰æ–‡ | âœ… 100% |
| â†’ Series Support | âœ“ | â­â­â­ | æ–‡ä»¶å¤¹ç³»ç»Ÿ | âœ… 100% |
| â†’ Import Novel | âœ“ | â­â­â­ | æ–‡ä»¶è§£æ+AI | âœ… 90% |
| â†’ History | âœ“ | â­â­ | å¡ç‰‡ç³»ç»Ÿ | âœ… 100% |
| â†’ Export | âœ“ | â­â­ | æ–‡æ¡£å¯¼å‡º | âœ… 100% |
| **å¤šæ¨¡å‹æ”¯æŒ** | Muse/GPT/Claude | â­â­â­ | Gemini/DeepSeek | âœ… 80% |

### **æ€»ä½“å¯å¤åˆ»åº¦: 95%**

**å®Œå…¨æ— æ³•å¤åˆ»çš„åŠŸèƒ½:**
- âŒ Museæ¨¡å‹(Sudowriteä¸“æœ‰,éœ€å¤§é‡å°è¯´è®­ç»ƒ)

**éƒ¨åˆ†å¤åˆ»çš„åŠŸèƒ½:**
- ğŸ”„ Visualize (éœ€é¢å¤–å›¾åƒç”ŸæˆAPI,éæ ¸å¿ƒ)
- ğŸ”„ è‡ªå®šä¹‰Plugins (éœ€å¤æ‚çš„AIæç¤ºè¯ç”Ÿæˆç³»ç»Ÿ)

**100%å¯å¤åˆ»çš„åŠŸèƒ½:**
- âœ… å…¨éƒ¨Story Bibleç³»ç»Ÿ
- âœ… å…¨éƒ¨åŸºç¡€å†™ä½œå·¥å…·
- âœ… å¤§éƒ¨åˆ†é«˜çº§åŠŸèƒ½

---

## ğŸš€ MVPå¼€å‘è®¡åˆ’(6å‘¨å®Œæˆæ ¸å¿ƒåŠŸèƒ½)

### **Week 1: åŸºç¡€æ¡†æ¶**
```
Day 1-2: Lovable AIåˆ›å»ºé¡¹ç›®,æ­å»ºå¸ƒå±€
Day 3-4: é¡¹ç›®ç®¡ç†(åˆ›å»º/åˆ—è¡¨/åˆ‡æ¢)
Day 5-6: Gemini APIé›†æˆæµ‹è¯•
Day 7: åŸºç¡€ç¼–è¾‘å™¨é›†æˆ(Lexical)
```

### **Week 2: Story Bible (æ ¸å¿ƒ1)**
```
Day 1-2: Braindump + Genre/Style
Day 3-4: Synopsisè‡ªåŠ¨ç”Ÿæˆ
Day 5-6: CharactersåŸºç¡€CRUD
Day 7: å­˜å‚¨ç³»ç»Ÿå®Œå–„
```

### **Week 3: å†™ä½œå·¥å…· (æ ¸å¿ƒ2)**
```
Day 1-2: Write (Autoæ¨¡å¼)
Day 3-4: Rewrite
Day 5-6: Describe + Expand
Day 7: å·¥å…·æ UIä¼˜åŒ–
```

### **Week 4: Story Bibleå®Œå–„**
```
Day 1-2: Worldbuildingç³»ç»Ÿ
Day 3-4: Outlineç³»ç»Ÿ(å¯æ‹–æ‹½)
Day 5-6: Sceneså¡ç‰‡
Day 7: Story Bibleè”åŠ¨æµ‹è¯•
```

### **Week 5: é«˜çº§å†™ä½œå·¥å…·**
```
Day 1-2: Write (Guided + Tone Shift)
Day 3-4: Brainstorm + Twist
Day 5-6: First Draft
Day 7: Historyé¢æ¿
```

### **Week 6: ä¼˜åŒ–ä¸ä¸­æ–‡ç‰¹è‰²**
```
Day 1-2: ä¸­æ–‡é™ˆè¯æ»¥è°ƒæ£€æµ‹
Day 3-4: ä¸­æ–‡ä½“è£/é£æ ¼é¢„è®¾
Day 5-6: UI/UXä¼˜åŒ–
Day 7: æµ‹è¯•ä¸ä¿®å¤Bug
```

**6å‘¨åå¯äº¤ä»˜:**
- âœ… å®Œæ•´çš„Story Bibleç³»ç»Ÿ
- âœ… 9ä¸ªæ ¸å¿ƒå†™ä½œå·¥å…·
- âœ… åŸºç¡€ç¼–è¾‘å™¨
- âœ… é¡¹ç›®ç®¡ç†
- âœ… Historyç³»ç»Ÿ
- âœ… ä¸­æ–‡ä¼˜åŒ–

---

## ğŸ¯ åç»­æ‰©å±•è®¡åˆ’

### **Phase 2 (4-6å‘¨): é«˜çº§åŠŸèƒ½**
- Canvaså¯è§†åŒ–
- é¢„è®¾Plugins (20-30ä¸ª)
- My Voiceé£æ ¼å­¦ä¹ 
- ChatåŠ©æ‰‹
- Seriesæ”¯æŒ
- Import/Exportå®Œå–„

### **Phase 3 (6-8å‘¨): ç”Ÿæ€ç³»ç»Ÿ**
- è‡ªå®šä¹‰Pluginsç³»ç»Ÿ
- ç”¨æˆ·ç¤¾åŒº
- æ’ä»¶å¸‚åœº
- åä½œåŠŸèƒ½
- ç§»åŠ¨ç«¯é€‚é…

---

## ğŸ’¡ å…³é”®æˆåŠŸå› ç´ 

### **1. Promptå·¥ç¨‹æ˜¯æ ¸å¿ƒ**
Sudowriteçš„Museæ¨¡å‹æ˜¯ä¸“é—¨è®­ç»ƒçš„,æˆ‘ä»¬æ— æ³•å¤åˆ»,ä½†å¯ä»¥é€šè¿‡:
- **ç²¾ç»†çš„Promptæ¨¡æ¿**
- **å¤§é‡ä¸­æ–‡å°è¯´ç¤ºä¾‹**(few-shot)
- **é™ˆè¯æ»¥è°ƒé»‘åå•**
- **å¤šè½®è¿­ä»£ä¼˜åŒ–**

æ¥æ¥è¿‘å…¶è´¨é‡ã€‚

### **2. Story Bibleæ˜¯çµé­‚**
å¿…é¡»ç¡®ä¿:
- Story Bibleçš„æ‰€æœ‰å­—æ®µéƒ½èƒ½è¢«AIè°ƒç”¨
- ä¸Šä¸‹æ–‡ç›¸å…³æ€§(Saliency)
- è‡ªåŠ¨æ›´æ–°å’ŒåŒæ­¥

### **3. ç”¨æˆ·ä½“éªŒæ˜¯å…³é”®**
- æµç•…çš„äº¤äº’
- å¿«é€Ÿçš„å“åº”(ä½¿ç”¨Flashæ¨¡å‹)
- æ¸…æ™°çš„UI
- åˆç†çš„é»˜è®¤å€¼

### **4. ä¸­æ–‡ä¼˜åŒ–æ˜¯å·®å¼‚åŒ–**
- æ­¦ä¾ /ä»™ä¾ ç­‰ä¸­æ–‡ä½“è£
- ä¸­æ–‡è¯­è¨€ä¹ æƒ¯
- ä¸­æ–‡é™ˆè¯æ»¥è°ƒåº“
- ä¸­æ–‡ç½‘æ–‡é£æ ¼

---

## ğŸ“ æ€»ç»“

### **âœ… å¯ä»¥å®Œæ•´å¤åˆ»å—?**

**ç­”æ¡ˆ: 95%å¯ä»¥!**

**æ— æ³•å¤åˆ»çš„:**
- Museä¸“æœ‰æ¨¡å‹(ä½†Gemini Proå¯ä»¥éå¸¸æ¥è¿‘)
- éƒ¨åˆ†é«˜çº§æ’ä»¶åŠŸèƒ½

**å®Œå…¨å¯ä»¥å¤åˆ»çš„:**
- å…¨éƒ¨Story Bibleç³»ç»Ÿ
- å…¨éƒ¨åŸºç¡€å’Œé«˜çº§å†™ä½œå·¥å…·
- å¤§éƒ¨åˆ†UI/UXåŠŸèƒ½
- é¡¹ç›®ç®¡ç†å’Œå­˜å‚¨
- å¤šæ¨¡å‹æ”¯æŒ

---

## ğŸ”¥ æ ¸å¿ƒç«äº‰åŠ›åˆ†æ

### **Sudowriteçš„æ ¸å¿ƒä¼˜åŠ¿:**
1. **Museæ¨¡å‹** - ä¸“ä¸ºå°è¯´è®­ç»ƒ,æ— å†…å®¹å®¡æŸ¥
2. **æˆç†Ÿçš„Promptå·¥ç¨‹** - ç»è¿‡å¤§é‡ç”¨æˆ·æµ‹è¯•ä¼˜åŒ–
3. **å®Œæ•´çš„Story Bibleç”Ÿæ€** - æ‰€æœ‰åŠŸèƒ½æ·±åº¦é›†æˆ
4. **æ´»è·ƒçš„æ’ä»¶ç¤¾åŒº** - 1000+ç”¨æˆ·åˆ›å»ºçš„æ’ä»¶
5. **æµç•…çš„ç”¨æˆ·ä½“éªŒ** - å¤šå¹´è¿­ä»£æ‰“ç£¨

### **æˆ‘ä»¬çš„å¯¹ç­–:**

#### **1. ç”¨Gemini + DeepSeekç»„åˆæ‹³**
```javascript
// æ™ºèƒ½æ¨¡å‹é€‰æ‹©ç­–ç•¥
const modelStrategy = {
  // åˆ›æ„ç”Ÿæˆ - ç”¨Gemini Pro
  creative: 'gemini-1.5-pro',
  
  // ä¸­æ–‡ä¼˜åŒ– - ç”¨DeepSeek
  chineseOptimized: 'deepseek-chat',
  
  // å¿«é€Ÿä»»åŠ¡ - ç”¨Gemini Flash
  fast: 'gemini-1.5-flash',
  
  // é•¿æ–‡æœ¬ - ç”¨Gemini Pro (æ”¯æŒ2M tokens)
  longContext: 'gemini-1.5-pro'
};

// æ ¹æ®ä»»åŠ¡è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¨¡å‹
function selectModel(task) {
  if (task.requiresChinese && task.genre in ['æ­¦ä¾ ', 'ä»™ä¾ ', 'ç„å¹»']) {
    return 'deepseek-chat';  // ä¸­æ–‡ç½‘æ–‡ä¼˜åŒ–
  }
  if (task.length > 1000) {
    return 'gemini-1.5-pro';
  }
  if (task.needsSpeed) {
    return 'gemini-1.5-flash';
  }
  return 'gemini-1.5-pro';  // é»˜è®¤
}
```

#### **2. å»ºç«‹ä¸­æ–‡å°è¯´è¯­æ–™åº“**
```javascript
// ä¸ºä¸åŒä½“è£å‡†å¤‡ç¤ºä¾‹
const chineseExamples = {
  æ­¦ä¾ : {
    style: `ä»–è„šå°–ä¸€ç‚¹ï¼Œèº«å½¢å¦‚é¬¼é­…èˆ¬æ¶ˆå¤±åœ¨åŸåœ°ã€‚ä¸‹ä¸€ç¬ï¼Œé•¿å‰‘å·²è‡³å¯¹æ–¹å’½å–‰ä¸‰å¯¸ã€‚`,
    avoid: ['çªç„¶', 'ç¬é—´', 'åªè§', 'ä½†è§']
  },
  
  ä»™ä¾ : {
    style: `çµæ°”åœ¨ç»è„‰ä¸­è¿è½¬ä¸‰åå…­å‘¨å¤©ï¼Œä¸¹ç”°å¤„é‡‘ä¸¹å¾®å¾®éœ‡é¢¤ï¼Œä¸€è‚¡ç²¾çº¯çš„çœŸå…ƒå–·è–„è€Œå‡ºã€‚`,
    avoid: ['çªç„¶çªç ´', 'åŸæ¥', 'ç«Ÿç„¶']
  },
  
  éƒ½å¸‚è¨€æƒ…: {
    style: `å¥¹å‚ä¸‹çœ¼ç«ï¼ŒæŒ‡å°–æ— æ„è¯†åœ°æ‘©æŒ²ç€å’–å•¡æ¯æ²¿ã€‚çª—å¤–ç»†é›¨éœéœï¼Œåƒå¥¹æ­¤åˆ»çš„å¿ƒæƒ…ã€‚`,
    avoid: ['çªç„¶', 'ä¸ç”±å¾—', 'å¿ƒä¸­ä¸€åŠ¨']
  },
  
  æ‚¬ç–‘æ¨ç†: {
    style: `ç°åœºçš„è¡€è¿¹å‘ˆæ”¾å°„çŠ¶åˆ†å¸ƒï¼Œè¿™æ„å‘³ç€å‡¶æ‰‹åœ¨è¡Œå‡¶æ—¶è·ç¦»å—å®³è€…ä¸åˆ°ä¸€ç±³ã€‚`,
    avoid: ['çªç„¶å‘ç°', 'åŸæ¥å¦‚æ­¤', 'çµå…‰ä¸€é—ª']
  }
};

// åœ¨ç”Ÿæˆæ—¶åŠ¨æ€æ³¨å…¥ç¤ºä¾‹
function buildPromptWithExamples(genre, task) {
  const example = chineseExamples[genre];
  return `
ã€é£æ ¼å‚è€ƒã€‘
${example.style}

ã€ç¦ç”¨è¯æ±‡ã€‘
${example.avoid.join('ã€')}

${task}
`;
}
```

#### **3. æ™ºèƒ½ä¸Šä¸‹æ–‡ç³»ç»Ÿ(Saliency Engineå¤åˆ»)**
```javascript
// Sudowriteçš„Saliency Engineä¼šè‡ªåŠ¨åˆ¤æ–­å“ªäº›Story Bibleå…ƒç´ ç›¸å…³
// æˆ‘ä»¬ç”¨ç®€å•çš„å…³é”®è¯åŒ¹é… + AIåˆ¤æ–­

class ContextManager {
  constructor(storyBible) {
    this.storyBible = storyBible;
  }
  
  // è·å–ç›¸å…³è§’è‰²
  async getRelevantCharacters(currentText, maxChars = 3) {
    // 1. å…³é”®è¯åŒ¹é…
    const mentioned = this.storyBible.characters.filter(char => 
      currentText.includes(char.name)
    );
    
    // 2. å¦‚æœæåˆ°çš„å°‘äºmaxCharsï¼Œç”¨AIåˆ¤æ–­
    if (mentioned.length < maxChars) {
      const prompt = `
å½“å‰æ–‡æœ¬: ${currentText}

å¯é€‰è§’è‰²:
${this.storyBible.characters.map(c => `- ${c.name}: ${c.description}`).join('\n')}

é—®é¢˜: é™¤äº†å·²ç»æåˆ°çš„è§’è‰²ï¼Œå“ªäº›è§’è‰²æœ€å¯èƒ½åœ¨æ¥ä¸‹æ¥çš„æƒ…èŠ‚ä¸­å‡ºç°ï¼Ÿ
è¿”å›è§’è‰²åç§°åˆ—è¡¨ï¼Œæœ€å¤š${maxChars - mentioned.length}ä¸ªã€‚

åªè¾“å‡ºJSONæ•°ç»„: ["è§’è‰²A", "è§’è‰²B"]
`;
      const result = await gemini.generate(prompt, { fast: true });
      const aiSuggested = JSON.parse(result);
      
      return [
        ...mentioned,
        ...this.storyBible.characters.filter(c => aiSuggested.includes(c.name))
      ].slice(0, maxChars);
    }
    
    return mentioned;
  }
  
  // è·å–ç›¸å…³ä¸–ç•Œè§‚å…ƒç´ 
  async getRelevantWorldbuilding(currentText, scene) {
    const location = scene?.location;
    const items = this.storyBible.worldbuilding.filter(w => 
      w.type === 'place' && w.name === location ||
      currentText.includes(w.name)
    );
    
    return items;
  }
  
  // æ„å»ºå®Œæ•´ä¸Šä¸‹æ–‡
  async buildContext(currentText, scene, options = {}) {
    const context = {
      genre: this.storyBible.genre,
      style: this.storyBible.style.text,
      synopsis: this.storyBible.synopsis
    };
    
    // æ™ºèƒ½æ·»åŠ ç›¸å…³ä¿¡æ¯
    if (options.includeCharacters !== false) {
      context.characters = await this.getRelevantCharacters(currentText);
    }
    
    if (options.includeWorldbuilding !== false) {
      context.worldbuilding = await this.getRelevantWorldbuilding(currentText, scene);
    }
    
    // æ·»åŠ å‰æ–‡ (Chapter Continuity)
    if (options.includePrevious) {
      context.previousChapter = await this.getPreviousChapterSummary();
    }
    
    return context;
  }
}
```

#### **4. é¢„è®¾æ’ä»¶åº“(ä¸­æ–‡ç‰¹è‰²)**
```javascript
// å†…ç½®20ä¸ªæœ€å¸¸ç”¨çš„æ’ä»¶

export const builtInPlugins = [
  // 1. å¯¹è¯å¢å¼º
  {
    id: 'dialogue-enhancer',
    name: 'å¯¹è¯æ¶¦è‰²',
    category: 'editing',
    instruction: `
è¯·æ¶¦è‰²ä»¥ä¸‹å¯¹è¯ï¼Œä½¿å…¶æ›´åŠ ç”ŸåŠ¨:
- æ·»åŠ è¯­æ°”è¯ã€åœé¡¿
- å¢åŠ è‚¢ä½“è¯­è¨€å’Œè¡¨æƒ…æå†™
- ç¬¦åˆäººç‰©æ€§æ ¼
- é¿å…"è¯´"å­—é‡å¤

åŸå¯¹è¯:
{{selected_text}}

è§’è‰²ä¿¡æ¯: {{characters}}

æä¾›3ä¸ªç‰ˆæœ¬ã€‚
    `
  },
  
  // 2. åœºæ™¯è®¾å®šç”Ÿæˆå™¨
  {
    id: 'scene-setter',
    name: 'åœºæ™¯é“ºå«',
    category: 'writing',
    instruction: `
ä¸ºä»¥ä¸‹åœºæ™¯ç”Ÿæˆå¼€åœºæå†™(200å­—):
{{scene_description}}

è¦æ±‚:
- æ¸²æŸ“æ°›å›´
- å»ºç«‹æƒ…ç»ªåŸºè°ƒ
- æš—ç¤ºå³å°†å‘ç”Ÿçš„äº‹ä»¶
- ä½¿ç”¨ç¯å¢ƒæå†™

ä½“è£: {{genre}}
    `
  },
  
  // 3. æ­¦ä¾ åŠ¨ä½œåœºé¢
  {
    id: 'wuxia-action',
    name: 'æ­¦ä¾ æ‰“æ–—',
    category: 'writing',
    instruction: `
ç”Ÿæˆä¸€æ®µæ­¦ä¾ æ‰“æ–—åœºé¢(300å­—):

äººç‰©A: {{character1}}
äººç‰©B: {{character2}}
åœ°ç‚¹: {{location}}
èµ·å› : {{conflict}}

è¦æ±‚:
- æå†™æ‹›å¼å’Œè½»åŠŸ
- ä½“ç°æ­¦åŠŸé£æ ¼
- æœ‰æ¥æœ‰å›
- ç¬¦åˆæ­¦ä¾ å°è¯´è¯­è¨€
    `
  },
  
  // 4. å¿ƒç†æå†™
  {
    id: 'inner-thoughts',
    name: 'å†…å¿ƒç‹¬ç™½',
    category: 'writing',
    instruction: `
ä¸ºä»¥ä¸‹æƒ…èŠ‚æ·»åŠ äººç‰©å†…å¿ƒç‹¬ç™½(150å­—):

æƒ…èŠ‚: {{selected_text}}
äººç‰©: {{pov_character}}
æƒ…ç»ª: {{emotion}}

è¦æ±‚:
- å±•ç°å†…å¿ƒæŒ£æ‰
- ç¬¦åˆäººç‰©æ€§æ ¼
- ä¸è¦ç›´ç™½è¯´æ•™
- ä½¿ç”¨æ„è¯†æµæ‰‹æ³•
    `
  },
  
  // 5. ä¿®ä»™çªç ´åœºæ™¯
  {
    id: 'cultivation-breakthrough',
    name: 'ä¿®ç‚¼çªç ´',
    category: 'writing',
    instruction: `
ç”Ÿæˆä¿®ä»™çªç ´åœºæ™¯(400å­—):

è§’è‰²: {{character}}
å½“å‰å¢ƒç•Œ: {{current_level}}
ç›®æ ‡å¢ƒç•Œ: {{next_level}}
ç¯å¢ƒ: {{location}}

è¦æ±‚:
- æå†™çµæ°”è¿è½¬
- å¢ƒç•Œæ„Ÿæ‚Ÿ
- å¤©åœ°å¼‚è±¡
- ç¬¦åˆä»™ä¾ å°è¯´é£æ ¼
    `
  },
  
  // 6. æƒ…èŠ‚æ¼æ´æ£€æµ‹
  {
    id: 'plot-hole-detector',
    name: 'æƒ…èŠ‚æ£€æŸ¥',
    category: 'analysis',
    instruction: `
æ£€æŸ¥ä»¥ä¸‹æ–‡æœ¬æ˜¯å¦å­˜åœ¨æƒ…èŠ‚æ¼æ´:

æ–‡æœ¬: {{selected_text}}
Story Bible: {{synopsis}} {{characters}}

æ£€æŸ¥é¡¹ç›®:
- äººç‰©è¡Œä¸ºæ˜¯å¦å‰åä¸€è‡´
- æ—¶é—´çº¿æ˜¯å¦åˆç†
- äººç‰©ä½ç½®å˜åŒ–æ˜¯å¦åˆç†
- æ˜¯å¦æœ‰é€»è¾‘çŸ›ç›¾

è¾“å‡ºJSONæ ¼å¼:
{
  "issues": [
    {
      "type": "æ—¶é—´çº¿é—®é¢˜",
      "description": "...",
      "suggestion": "..."
    }
  ]
}
    `
  },
  
  // 7. å®«æ–—é˜´è°‹ç­–åˆ’
  {
    id: 'palace-intrigue',
    name: 'å®«æ–—ç­–ç•¥',
    category: 'brainstorm',
    instruction: `
ä¸ºä»¥ä¸‹å®«æ–—æƒ…èŠ‚è®¾è®¡é˜´è°‹:

ä¸»è§’: {{protagonist}}
å¯¹æ‰‹: {{antagonist}}
ç›®æ ‡: {{goal}}
ç°æœ‰èµ„æº: {{resources}}

ç”Ÿæˆ5ä¸ªé˜´è°‹æ–¹æ¡ˆï¼Œæ¯ä¸ªåŒ…å«:
- è®¡ç­–æ¦‚è¿°
- æ‰§è¡Œæ­¥éª¤
- é£é™©è¯„ä¼°
- é¢„æœŸæ•ˆæœ
    `
  },
  
  // 8. æ„Ÿå®˜æå†™å¢å¼º
  {
    id: 'sensory-details',
    name: 'äº”æ„Ÿæå†™',
    category: 'editing',
    instruction: `
ä¸ºä»¥ä¸‹åœºæ™¯æ·»åŠ äº”æ„Ÿæå†™:

åŸæ–‡: {{selected_text}}

è¦æ±‚:
- è§†è§‰ã€å¬è§‰ã€å—…è§‰ã€è§¦è§‰ã€å‘³è§‰
- ä¸æ”¹å˜æƒ…èŠ‚
- åˆ¶é€ æ²‰æµ¸æ„Ÿ
- æ¯ç§æ„Ÿå®˜è‡³å°‘ä¸€å¤„

æä¾›2ä¸ªç‰ˆæœ¬ã€‚
    `
  },
  
  // 9. æ‚¬å¿µåˆ¶é€ 
  {
    id: 'suspense-builder',
    name: 'æ‚¬å¿µè¥é€ ',
    category: 'editing',
    instruction: `
æ”¹å†™ä»¥ä¸‹æ®µè½ï¼Œå¢åŠ æ‚¬å¿µæ„Ÿ:

åŸæ–‡: {{selected_text}}

æŠ€å·§:
- å»¶è¿Ÿä¿¡æ¯é€éœ²
- å¢åŠ ä¸ç¡®å®šæ€§
- ä½¿ç”¨æš—ç¤º
- åˆ¶é€ ç´§å¼ æ„Ÿ

ä¿æŒåŸæ„ï¼Œä½†æ›´å¸å¼•äººã€‚
    `
  },
  
  // 10. è§’è‰²å…³ç³»å›¾è°±
  {
    id: 'relationship-mapper',
    name: 'å…³ç³»æ¢³ç†',
    category: 'analysis',
    instruction: `
åˆ†æä»¥ä¸‹æ–‡æœ¬ä¸­çš„äººç‰©å…³ç³»:

æ–‡æœ¬: {{selected_text}}
è§’è‰²: {{characters}}

è¾“å‡ºJSONæ ¼å¼:
{
  "relationships": [
    {
      "from": "è§’è‰²A",
      "to": "è§’è‰²B",
      "type": "å¸ˆå¾’/æƒ…ä¾£/ä»‡æ•Œ/...",
      "description": "å…³ç³»æè¿°",
      "status": "å½“å‰çŠ¶æ€"
    }
  ]
}
    `
  },
  
  // 11. ç« èŠ‚ç»“å°¾é’©å­
  {
    id: 'chapter-hook',
    name: 'ç« èŠ‚é’©å­',
    category: 'writing',
    instruction: `
ä¸ºå½“å‰ç« èŠ‚ç”Ÿæˆå¼•äººå…¥èƒœçš„ç»“å°¾(100å­—):

å½“å‰æƒ…èŠ‚: {{selected_text}}
ä¸‹ä¸€ç« é¢„å‘Š: {{next_chapter}}

è¦æ±‚:
- åˆ¶é€ æ‚¬å¿µ
- å¼•å‘å¥½å¥‡
- ä¿ƒä½¿è¯»è€…ç»§ç»­é˜…è¯»
- 3ä¸ªç‰ˆæœ¬
    `
  },
  
  // 12. å¿«èŠ‚å¥æ”¹å†™
  {
    id: 'pace-up',
    name: 'èŠ‚å¥åŠ å¿«',
    category: 'editing',
    instruction: `
å°†ä»¥ä¸‹æ–‡æœ¬æ”¹å†™å¾—æ›´ç´§å‡‘å¿«é€Ÿ:

åŸæ–‡: {{selected_text}}

æ–¹æ³•:
- ç¼©çŸ­å¥å­
- åˆ é™¤å†—ä½™æå†™
- å¢åŠ åŠ¨ä½œ
- åˆ¶é€ ç´§è¿«æ„Ÿ

ä¿ç•™å…³é”®ä¿¡æ¯ã€‚
    `
  },
  
  // 13. æ…¢èŠ‚å¥æ”¹å†™
  {
    id: 'pace-down',
    name: 'èŠ‚å¥æ”¾æ…¢',
    category: 'editing',
    instruction: `
å°†ä»¥ä¸‹æ–‡æœ¬æ”¹å†™å¾—æ›´èˆ’ç¼“ç»†è…»:

åŸæ–‡: {{selected_text}}

æ–¹æ³•:
- å¢åŠ ç»†èŠ‚æå†™
- æ‹‰é•¿å¥å­
- æ·»åŠ å¿ƒç†æå†™
- è¥é€ æ°›å›´

ä¸æ”¹å˜æ ¸å¿ƒæƒ…èŠ‚ã€‚
    `
  },
  
  // 14. å‘½åç”Ÿæˆå™¨
  {
    id: 'name-generator',
    name: 'è§’è‰²å‘½å',
    category: 'brainstorm',
    instruction: `
ä¸ºä»¥ä¸‹è§’è‰²ç”Ÿæˆåˆé€‚çš„åå­—:

è§’è‰²è®¾å®š: {{character_description}}
ä½“è£: {{genre}}
æ€§åˆ«: {{gender}}

è¦æ±‚:
- ç¬¦åˆä½“è£é£æ ¼
- æœ‰å¯“æ„æˆ–è±¡å¾
- æœ—æœ—ä¸Šå£
- ç”Ÿæˆ10ä¸ªå€™é€‰

æ¯ä¸ªåå­—é™„ä¸Šå«ä¹‰è§£é‡Šã€‚
    `
  },
  
  // 15. å†²çªå‡çº§
  {
    id: 'conflict-escalator',
    name: 'å†²çªæ¿€åŒ–',
    category: 'brainstorm',
    instruction: `
åŸºäºå½“å‰å†²çªï¼Œè®¾è®¡å‡çº§æ–¹æ¡ˆ:

å½“å‰å†²çª: {{current_conflict}}
æ¶‰åŠäººç‰©: {{characters}}

ç”Ÿæˆ5ä¸ªå†²çªå‡çº§ç‚¹:
- å¤–éƒ¨å‹åŠ›åŠ å‰§
- å†…éƒ¨çŸ›ç›¾æ¿€åŒ–
- æ„å¤–äº‹ä»¶ä»‹å…¥
- ç¬¬ä¸‰æ–¹æ…å±€
- é“å¾·å›°å¢ƒ

æ¯ä¸ªåŒ…å«å…·ä½“æƒ…èŠ‚ã€‚
    `
  },
  
  // 16. æ–‡é£ç»Ÿä¸€
  {
    id: 'style-unifier',
    name: 'é£æ ¼ç»Ÿä¸€',
    category: 'editing',
    instruction: `
å°†ä»¥ä¸‹æ–‡æœ¬æ”¹å†™ä¸ºä¸ç›®æ ‡é£æ ¼ä¸€è‡´:

åŸæ–‡: {{selected_text}}
ç›®æ ‡é£æ ¼: {{style}}

åˆ†æå·®å¼‚å¹¶è°ƒæ•´:
- å¥å¼ç»“æ„
- è¯æ±‡é€‰æ‹©
- è¯­æ°”è¯­è°ƒ
- ä¿®è¾æ‰‹æ³•
    `
  },
  
  // 17. ä¼ç¬”è®¾ç½®
  {
    id: 'foreshadowing',
    name: 'åŸ‹ä¼ç¬”',
    category: 'writing',
    instruction: `
åœ¨å½“å‰åœºæ™¯ä¸­åŸ‹ä¸‹ä¼ç¬”:

åœºæ™¯: {{selected_text}}
è¦æš—ç¤ºçš„å†…å®¹: {{future_event}}

è¦æ±‚:
- ä¸åŠ¨å£°è‰²
- è‡ªç„¶èå…¥
- äº‹åæç„¶å¤§æ‚Ÿ
- æä¾›3ç§åŸ‹æ³•
    `
  },
  
  // 18. å¯¹æ¯”æ”¹å†™
  {
    id: 'contrast-rewrite',
    name: 'å¯¹æ¯”ç‰ˆæœ¬',
    category: 'editing',
    instruction: `
ç”¨ä¸‰ç§å®Œå…¨ä¸åŒçš„é£æ ¼æ”¹å†™:

åŸæ–‡: {{selected_text}}

ç‰ˆæœ¬A: ç®€æ´ç‰ˆ (æµ·æ˜å¨é£æ ¼)
ç‰ˆæœ¬B: åä¸½ç‰ˆ (å¤å…¸æ–‡å­¦é£æ ¼)
ç‰ˆæœ¬C: ç½‘æ–‡ç‰ˆ (é€šä¿—æ˜“æ‡‚)

ä¿æŒæƒ…èŠ‚ä¸€è‡´ã€‚
    `
  },
  
  // 19. æ ‡é¢˜ç”Ÿæˆå™¨
  {
    id: 'title-generator',
    name: 'ç« èŠ‚æ ‡é¢˜',
    category: 'brainstorm',
    instruction: `
ä¸ºä»¥ä¸‹ç« èŠ‚å†…å®¹ç”Ÿæˆæ ‡é¢˜:

å†…å®¹æ¦‚æ‹¬: {{chapter_summary}}
ä½“è£: {{genre}}

è¦æ±‚:
- å¸å¼•çœ¼çƒ
- æš—ç¤ºå†…å®¹ä½†ä¸å‰§é€
- ç¬¦åˆä½“è£é£æ ¼
- ç”Ÿæˆ10ä¸ªå€™é€‰

é£æ ¼å¯å¤šæ ·: å¯¹è”å¼ã€æ‚¬å¿µå¼ã€è¯—æ„å¼ç­‰
    `
  },
  
  // 20. æƒ…ç»ªæ¸²æŸ“
  {
    id: 'emotion-amplifier',
    name: 'æƒ…ç»ªåŠ å¼º',
    category: 'editing',
    instruction: `
å¼ºåŒ–ä»¥ä¸‹æ–‡æœ¬çš„æƒ…ç»ªæ„ŸæŸ“åŠ›:

åŸæ–‡: {{selected_text}}
ç›®æ ‡æƒ…ç»ª: {{target_emotion}}

æŠ€å·§:
- æ„Ÿå®˜ç»†èŠ‚
- ç¯å¢ƒçƒ˜æ‰˜
- è‚¢ä½“è¯­è¨€
- å¿ƒç†æå†™

è®©è¯»è€…æ„ŸåŒèº«å—ã€‚
    `
  }
];

// æ’ä»¶æ‰§è¡Œå™¨
class PluginExecutor {
  constructor(geminiService) {
    this.gemini = geminiService;
  }
  
  async execute(plugin, variables, storyBible) {
    // 1. æ›¿æ¢å˜é‡
    let prompt = plugin.instruction;
    for (const [key, value] of Object.entries(variables)) {
      prompt = prompt.replace(`{{${key}}}`, value);
    }
    
    // 2. æ·»åŠ Story Bibleä¸Šä¸‹æ–‡
    if (plugin.enableStoryBible) {
      prompt = `
ã€Story Bibleã€‘
ä½“è£: ${storyBible.genre}
é£æ ¼: ${storyBible.style.text}
æ¦‚è¦: ${storyBible.synopsis}

${prompt}
`;
    }
    
    // 3. æ‰§è¡Œç”Ÿæˆ
    const result = await this.gemini.generate(prompt, {
      temperature: plugin.temperature || 0.8,
      maxTokens: plugin.maxTokens || 2048
    });
    
    return result;
  }
}
```

---

## ğŸ¨ å®Œæ•´UIè®¾è®¡æ–¹æ¡ˆ

### **ä¸»ç•Œé¢å®Œæ•´å¸ƒå±€**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å¢¨è¯­] é¡¹ç›®: ã€Šä¿®ä»™ä¼ ã€‹        [ä¿å­˜] [å¯¼å‡º] [è®¾ç½®] [ğŸ‘¤ç”¨æˆ·]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¡¹ç›®  â”‚                ç¼–è¾‘åŒºåŸŸ                â”‚ Story Bible   â”‚
â”‚ å¯¼èˆª  â”‚                                        â”‚               â”‚
â”‚       â”‚                                        â”‚ [ğŸ“šæ¦‚è¦]      â”‚
â”‚ ğŸ“é¡¹ç›®â”‚  ç¬¬ä¸‰ç«  çªç ´                            â”‚ ä½“è£: ä»™ä¾     â”‚
â”‚  â”œâ”€æ–‡â”‚                                        â”‚ é£æ ¼: å¤å…¸    â”‚
â”‚  â”‚æ¡£1â”‚  çµæ°”åœ¨ç»è„‰ä¸­è¿è½¬ä¸‰åå…­å‘¨å¤©ï¼Œä¸¹ç”°      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  â”‚   â”‚  å¤„é‡‘ä¸¹å¾®å¾®éœ‡é¢¤ã€‚[å…‰æ ‡]                â”‚ [ğŸ‘¤è§’è‰²]      â”‚
â”‚  â”œâ”€æ–‡â”‚                                        â”‚ â”œ æ—å¤©        â”‚
â”‚  â”‚æ¡£2â”‚                                        â”‚ â”œ è‹å©‰å„¿      â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”” äº‘é•¿è€      â”‚
â”‚  â””â”€æ–‡â”‚  â”‚ ğŸ’¡ AIå»ºè®®                â”‚           â”‚               â”‚
â”‚   æ¡£3â”‚  â”‚ â—‹ æå†™çªç ´æ—¶çš„å¤©åœ°å¼‚è±¡    â”‚           â”‚ [ğŸŒä¸–ç•Œè§‚]    â”‚
â”‚ â”€â”€â”€â”€ â”‚  â”‚ â—‹ åŠ å…¥å›å¿†æ€ï¼Œäº¤ä»£å‰å›    â”‚           â”‚ â”œ å¤©äº‘å®—      â”‚
â”‚ ğŸ“ç³»åˆ—â”‚  â”‚ â—‹ å¢åŠ æƒ…ç»ªæå†™           â”‚           â”‚ â”œ é’äº‘å³°      â”‚
â”‚ 1    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”” çµçŸ³        â”‚
â”‚ â”€â”€â”€â”€ â”‚                                        â”‚               â”‚
â”‚ + æ–°å»ºâ”‚                                        â”‚ [ğŸ“å¤§çº²]      â”‚
â”‚      â”‚                                        â”‚ ç¬¬ä¸€ç«  âœ“      â”‚
â”‚      â”‚                                        â”‚ ç¬¬äºŒç«  âœ“      â”‚
â”‚      â”‚                                        â”‚ ç¬¬ä¸‰ç«  â† å½“å‰ â”‚
â”‚      â”‚                                        â”‚ ç¬¬å››ç«         â”‚
â”‚      â”‚                                        â”‚               â”‚
â”‚      â”‚                                        â”‚ [ğŸ¬åœºæ™¯]      â”‚
â”‚      â”‚                                        â”‚ åœºæ™¯1: ä¿®ç‚¼   â”‚
â”‚      â”‚                                        â”‚ åœºæ™¯2: çªç ´   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [âœ¨ç»­å†™â–¼] [ğŸ”„æ”¹å†™] [ğŸ‘ï¸æå†™] [ğŸ“æ‰©å±•] [ğŸ’¡å¤´è„‘é£æš´] [ğŸ”Œæ’ä»¶â–¼] â”‚3,247å­—â”‚
â”‚  Auto  Guided Tone                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **æ’ä»¶ç•Œé¢è®¾è®¡**

```
â”Œâ”€ æ’ä»¶å·¥å…·ç®± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                        â”‚
â”‚ [æœç´¢æ’ä»¶...]               [+ è‡ªå®šä¹‰] â”‚
â”‚                                        â”‚
â”‚ ğŸ“ å†™ä½œç±»                              â”‚
â”‚  â”œâ”€ æ­¦ä¾ æ‰“æ–—                    â­â­â­  â”‚
â”‚  â”œâ”€ ä¿®ç‚¼çªç ´                    â­â­â­  â”‚
â”‚  â”œâ”€ åœºæ™¯é“ºå«                    â­â­   â”‚
â”‚  â””â”€ å¯¹è¯ç”Ÿæˆ                    â­â­   â”‚
â”‚                                        â”‚
â”‚ âœï¸ ç¼–è¾‘ç±»                              â”‚
â”‚  â”œâ”€ å¯¹è¯æ¶¦è‰²                    â­â­â­  â”‚
â”‚  â”œâ”€ äº”æ„Ÿæå†™                    â­â­   â”‚
â”‚  â”œâ”€ èŠ‚å¥è°ƒæ•´                    â­â­   â”‚
â”‚  â””â”€ é£æ ¼ç»Ÿä¸€                    â­     â”‚
â”‚                                        â”‚
â”‚ ğŸ” åˆ†æç±»                              â”‚
â”‚  â”œâ”€ æƒ…èŠ‚æ£€æŸ¥                    â­â­   â”‚
â”‚  â”œâ”€ å…³ç³»æ¢³ç†                    â­     â”‚
â”‚  â””â”€ ä¸€è‡´æ€§æ£€æµ‹                  â­     â”‚
â”‚                                        â”‚
â”‚ ğŸ’­ åˆ›æ„ç±»                              â”‚
â”‚  â”œâ”€ å†²çªå‡çº§                    â­â­   â”‚
â”‚  â”œâ”€ è§’è‰²å‘½å                    â­â­â­  â”‚
â”‚  â”œâ”€ æ ‡é¢˜ç”Ÿæˆ                    â­â­   â”‚
â”‚  â””â”€ ä¼ç¬”è®¾è®¡                    â­     â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»æ’ä»¶å:
â”Œâ”€ æ­¦ä¾ æ‰“æ–—ç”Ÿæˆå™¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                        â”‚
â”‚ äººç‰©A: [æ—å¤©]                          â”‚
â”‚ äººç‰©B: [é»‘è¡£äºº]                        â”‚
â”‚ åœ°ç‚¹: [é’äº‘å³°æ‚¬å´–]                     â”‚
â”‚ èµ·å› : [äº‰å¤ºçµè¯]                       â”‚
â”‚                                        â”‚
â”‚ é«˜çº§é€‰é¡¹ â–¼                             â”‚
â”‚  â–¡ ä½¿ç”¨Story Bible                    â”‚
â”‚  â–¡ åŒ…å«å†…å¿ƒç‹¬ç™½                        â”‚
â”‚  é•¿åº¦: [â—â”€â”€â”€â”€â”€â”€â”€â”€â”€] 300å­—             â”‚
â”‚                                        â”‚
â”‚        [å–æ¶ˆ]      [ç”Ÿæˆ âœ¨]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š å®Œæ•´æ•°æ®å­˜å‚¨æ–¹æ¡ˆ

### **å­˜å‚¨æ¶æ„**

```javascript
// ä½¿ç”¨window.storage API (Claude ArtifactsæŒä¹…åŒ–)

const StorageService = {
  // === é¡¹ç›®ç®¡ç† ===
  
  async listProjects() {
    try {
      const result = await window.storage.get('projects-index');
      return result ? JSON.parse(result.value) : [];
    } catch {
      return [];
    }
  },
  
  async createProject(project) {
    // 1. ä¿å­˜é¡¹ç›®æ•°æ®
    await window.storage.set(
      `project:${project.id}`,
      JSON.stringify(project)
    );
    
    // 2. æ›´æ–°ç´¢å¼•
    const projects = await this.listProjects();
    projects.push({ id: project.id, title: project.title, createdAt: Date.now() });
    await window.storage.set('projects-index', JSON.stringify(projects));
    
    return project;
  },
  
  async getProject(projectId) {
    const result = await window.storage.get(`project:${projectId}`);
    return result ? JSON.parse(result.value) : null;
  },
  
  async updateProject(projectId, updates) {
    const project = await this.getProject(projectId);
    const updated = { ...project, ...updates, updatedAt: Date.now() };
    await window.storage.set(`project:${projectId}`, JSON.stringify(updated));
    return updated;
  },
  
  async deleteProject(projectId) {
    // åˆ é™¤é¡¹ç›®åŠæ‰€æœ‰ç›¸å…³æ•°æ®
    await window.storage.delete(`project:${projectId}`);
    await window.storage.delete(`story-bible:${projectId}`);
    
    // åˆ é™¤æ‰€æœ‰æ–‡æ¡£
    const documents = await this.listDocuments(projectId);
    for (const doc of documents) {
      await window.storage.delete(`document:${doc.id}`);
    }
    
    // æ›´æ–°ç´¢å¼•
    const projects = await this.listProjects();
    const filtered = projects.filter(p => p.id !== projectId);
    await window.storage.set('projects-index', JSON.stringify(filtered));
  },
  
  // === Story Bible ===
  
  async getStoryBible(projectId) {
    try {
      const result = await window.storage.get(`story-bible:${projectId}`);
      return result ? JSON.parse(result.value) : this.createEmptyStoryBible();
    } catch {
      return this.createEmptyStoryBible();
    }
  },
  
  async updateStoryBible(projectId, storyBible) {
    await window.storage.set(
      `story-bible:${projectId}`,
      JSON.stringify(storyBible)
    );
  },
  
  createEmptyStoryBible() {
    return {
      braindump: '',
      genre: '',
      style: { text: '', file: null },
      synopsis: '',
      characters: [],
      worldbuilding: [],
      outline: [],
      scenes: []
    };
  },
  
  // === æ–‡æ¡£ ===
  
  async listDocuments(projectId) {
    const keys = await window.storage.list(`document:${projectId}:`);
    const documents = [];
    
    if (keys) {
      for (const key of keys.keys) {
        const result = await window.storage.get(key);
        if (result) {
          documents.push(JSON.parse(result.value));
        }
      }
    }
    
    return documents;
  },
  
  async getDocument(documentId) {
    const result = await window.storage.get(`document:${documentId}`);
    return result ? JSON.parse(result.value) : null;
  },
  
  async saveDocument(document) {
    await window.storage.set(
      `document:${document.id}`,
      JSON.stringify({
        ...document,
        updatedAt: Date.now()
      })
    );
  },
  
  // === History (AIç”Ÿæˆå†å²) ===
  
  async getHistory(projectId) {
    try {
      const result = await window.storage.get(`history:${projectId}`);
      return result ? JSON.parse(result.value) : [];
    } catch {
      return [];
    }
  },
  
  async addToHistory(projectId, entry) {
    const history = await this.getHistory(projectId);
    history.unshift({
      id: Date.now(),
      timestamp: Date.now(),
      ...entry
    });
    
    // åªä¿ç•™æœ€è¿‘100æ¡
    const trimmed = history.slice(0, 100);
    
    await window.storage.set(
      `history:${projectId}`,
      JSON.stringify(trimmed)
    );
  },
  
  // === è®¾ç½® ===
  
  async getSettings() {
    try {
      const result = await window.storage.get('app-settings');
      return result ? JSON.parse(result.value) : this.getDefaultSettings();
    } catch {
      return this.getDefaultSettings();
    }
  },
  
  async updateSettings(settings) {
    await window.storage.set('app-settings', JSON.stringify(settings));
  },
  
  getDefaultSettings() {
    return {
      apiKey: '',
      defaultModel: 'gemini-1.5-pro',
      theme: 'light',
      fontSize: 16,
      autoSave: true,
      autoSaveInterval: 30000  // 30ç§’
    };
  },
  
  // === å¯¼å‡º/å¯¼å…¥ ===
  
  async exportProject(projectId) {
    const project = await this.getProject(projectId);
    const storyBible = await this.getStoryBible(projectId);
    const documents = await this.listDocuments(projectId);
    
    return {
      version: '1.0',
      exportedAt: Date.now(),
      project,
      storyBible,
      documents
    };
  },
  
  async importProject(data) {
    const projectId = `project_${Date.now()}`;
    
    await this.createProject({
      ...data.project,
      id: projectId
    });
    
    await this.updateStoryBible(projectId, data.storyBible);
    
    for (const doc of data.documents) {
      await this.saveDocument({
        ...doc,
        id: `${projectId}:${doc.id}`
      });
    }
    
    return projectId;
  }
};
```

---

## ğŸš€ ç«‹å³å¼€å§‹å®ç°

### **Step 1: åœ¨Lovable AIåˆ›å»ºé¡¹ç›®**

```bash
# é¡¹ç›®ç»“æ„
moyu-writer/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Editor/
â”‚   â”‚   â”‚   â”œâ”€â”€ WritingEditor.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditorToolbar.jsx
â”‚   â”‚   â”‚   â””â”€â”€ FloatingToolbar.jsx
â”‚   â”‚   â”œâ”€â”€ StoryBible/
â”‚   â”‚   â”‚   â”œâ”€â”€ StoryBiblePanel.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ BraindumpSection.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SynopsisSection.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CharactersSection.jsx
â”‚   â”‚   â”‚   â””â”€â”€ OutlineSection.jsx
â”‚   â”‚   â”œâ”€â”€ Plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ PluginBrowser.jsx
â”‚   â”‚   â”‚   â””â”€â”€ PluginExecutor.jsx
â”‚   â”‚   â””â”€â”€ ui/  (shadcnç»„ä»¶)
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â”œâ”€â”€ ProjectContext.jsx
â”‚   â”‚   â”œâ”€â”€ StoryBibleContext.jsx
â”‚   â”‚   â””â”€â”€ EditorContext.jsx
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ gemini.js
â”‚   â”‚   â”œâ”€â”€ storage.js
â”‚   â”‚   â””â”€â”€ contextManager.js
â”‚   â”œâ”€â”€ prompts/
â”‚   â”‚   â””â”€â”€ templates.js
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ plugins.js
â”‚   â”‚   â””â”€â”€ chineseExamples.js
â”‚   â””â”€â”€ App.jsx
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### **Step 2: æ ¸å¿ƒä»£ç å®ç°**

æˆ‘å¯ä»¥ä¸ºä½ ç”Ÿæˆ:
1. âœ… å®Œæ•´çš„Reacté¡¹ç›®æ¡†æ¶
2. âœ… æ‰€æœ‰ç»„ä»¶ä»£ç 
3. âœ… Gemini APIé›†æˆ
4. âœ… StorageæœåŠ¡
5. âœ… 20ä¸ªé¢„è®¾æ’ä»¶
6. âœ… æ‰€æœ‰Promptæ¨¡æ¿

### **Step 3: éƒ¨ç½²**

- Lovable AIè‡ªåŠ¨éƒ¨ç½²
- æˆ–å¯¼å‡ºä»£ç éƒ¨ç½²åˆ°Vercel/Netlify

---

## ğŸ¯ æœ€ç»ˆç­”æ¡ˆ

### **âœ… èƒ½å¦100%å¤åˆ»Sudowrite?**

**ç­”æ¡ˆ: èƒ½å¤åˆ»95%çš„åŠŸèƒ½ï¼**

**å®Œå…¨å¯ä»¥å¤åˆ»(100%):**
- âœ… Story Bibleå®Œæ•´ç³»ç»Ÿ
- âœ… æ‰€æœ‰åŸºç¡€å†™ä½œå·¥å…·
- âœ… å¤§éƒ¨åˆ†é«˜çº§åŠŸèƒ½
- âœ… é¡¹ç›®ç®¡ç†
- âœ… Historyç³»ç»Ÿ
- âœ… å¯¼å…¥/å¯¼å‡º
- âœ… å¤šæ¨¡å‹æ”¯æŒ

**å¯ä»¥éƒ¨åˆ†å¤åˆ»(80-90%):**
- ğŸ”„ Canvas (ä½¿ç”¨React Flow)
- ğŸ”„ My Voice (Few-shotå­¦ä¹ )
- ğŸ”„ Plugins (é¢„è®¾+ç®€åŒ–è‡ªå®šä¹‰)
- ğŸ”„ Saliency Engine (ç®€åŒ–ç‰ˆä¸Šä¸‹æ–‡ç®¡ç†)

**æ— æ³•å¤åˆ»(ä¸“æœ‰æŠ€æœ¯):**
- âŒ Museæ¨¡å‹ (ä½†Gemini Proè´¨é‡æ¥è¿‘)
- âŒ å®Œæ•´çš„ç”¨æˆ·åˆ›å»ºæ’ä»¶ç”Ÿæ€ (éœ€å¤§é‡ç”¨æˆ·)

**æˆ‘ä»¬çš„ä¼˜åŠ¿:**
- âœ… **ä¸­æ–‡ä¼˜åŒ–**